;
; AR2FA0A  2.1.0m  TONY FORBES  December 1994 
;
; a = a^2  (using FFT modulo F_10)
;
; xsqufftA0 (&a, d, &f);
;
; Registers:   EAX = &a, EDX = d = d(a), 
;              EDX = &f, a 135201-digit work area (4097*132 = 540804 bytes)
; Assumptions: d(a) > 0
;              a has sufficient space according to the 
;              following scheme:
;              
;                 0 < d(a) <=   252  :  cap(a) >= 2*d(a)
;               252 < d(a) <=   504  :  cap(a) >= 1008
;               504 < d(a) <=  1008  :  cap(a) >= 2016
;              1008 < d(a) <=  2016  :  cap(a) >= 4032
;              2016 < d(a) <=  4032  :  cap(a) >= 8064
;              4032 < d(a) <=  8064  :  cap(a) >= 16128
;              8064 < d(a) <= 16128  :  cap(a) >= 32256
;             16128 < d(a) <= 32256  :  cap(a) >= 64512
;             32256 < d(a)           :  cap(a) >= 2*d(a)
;
;              max(2*d(a), min(4*d(a), 64512)) is sufficient
;
; Finite Fourier Transform for a => a^2.
;
; F  the Fermat number F_10 =  2^1024 + 1.
; D  the dimension of the Fourier transform.
; G  a Dth root of unity modulo F.
; M  the base for representation of a, m = 2^504.
;
; Parameters for FFT with F = 2^1024 + 1 and M = 2^504
;
;   log2 D     D           G           Nmax
;    
;     12     4096     2^768-2^256    2^1032192
;     11     2048          2         2^516096
;     10     1024          4         2^258048
;      9      512         16         2^129024
;      8      256        256         2^64512
;      7      128      65536         2^32256
;      6       64       2^32         2^16128
;
; F[X](k) = Sum[i=0 to D-1: X(i)G^k (mod F)
;
; Fast Fourier Transform
;
;    X(D,k,i) = X(i)
;    X(d,k,i) = X(2d,k,i) + X(2d,k,i+d)G^dk  (mod F)
;    F[X](k)  = X(1,k,0)
;
; Convolution Theorem:  F[(F[X]'.F[X]')] = D X*X,
;
; where  F[X]'  is the permutation of the vector  F[X]
; defined by  F[X]'(0) = F[X](0), F[X]'(i) = F[X](D-i),
; i = 1, 2, ..., D-1.
;
; a   = Sum[i=0 to D/2-1: 2^(iM) X(i)]
; a^2 = Sum[i=0 to D-2: 2^(iM) [X*X](i)]
; 
_DATA   segment dword public 'DATA'
         public _AR2FA0data
_AR2FA0data dd 0
         org    _AR2FA0data
Zcx      dd     0         ; Save ECX
Zbp      dd     0         ; Save EBP
Zsi      dd     0         ; Save ESI
Zdi      dd     0         ; Save EDI
ZYptr    dd     0         ; EAX = &a
ZXptr    dd     0         ; EBX = &f
;
; Constants for FFT array
LnF      =      33*4      ; length of F
LnM      =      63        ; length of M
Lk0      =      0         ; offset to block 0
Lk1      =      1024*33*4 ; offset to block 1
Lk2      =      2048*33*4 ; offset to block 2
Lk3      =      3072*33*4 ; offset to block 3
Lk4      =      4096*33*4 ; offset to end of FFT array
Li4      =      4096      ; index of end of FFT array
;
; FFT work areas
ZU       DD     65 dup (0)
ZW       DD     33 dup (0)
;
; Global FFT variables
ZGDim    DD     0        ; Dimension D
ZGlgD    DD     0        ; log2 D
ZGLbF    DD     0        ; F-block size = LnF*4096/D 
;
; Variables for XfftA
ZGe      DD     0
ZFd      DD     0
ZFi      DD     0
ZFe      DD     0
ZFb      DD     0
ZFj      DD     0
ZFk      DD     0
ZFkd     DD     0
;
; Data for XfftQ
ZStab    DD     0        ; X(i)^2 control table
ZSind    DD     0        ; X(i)^2 control index
ZSpar    DD     TqC-TqC,2*(4096+33)
         DD     TqB-TqC,2*(2048+33)
         DD     TqA-TqC,2*(1024+17)
         DD     Tq9-TqC,2*(512+17)
         DD     Tq8-TqC,2*(256+9)
         DD     Tq7-TqC,2*(128+9)
         DD     Tq6-TqC,2*(64+5)
         DD     Tq5-TqC,2*(32+5)
;
; Bit reversal table, i => b(i), 
; b(i) = i bit-reversed modulo 4096
Tb  DW   0,2048,1024,3072,512,2560,1536,3584
    DW   256,2304,1280,3328,768,2816,1792,3840
    DW   128,2176,1152,3200,640,2688,1664,3712
    DW   384,2432,1408,3456,896,2944,1920,3968
    DW   64,2112,1088,3136,576,2624,1600,3648
    DW   320,2368,1344,3392,832,2880,1856,3904
    DW   192,2240,1216,3264,704,2752,1728,3776
    DW   448,2496,1472,3520,960,3008,1984,4032
;
    DW   32,2080,1056,3104,544,2592,1568,3616
    DW   288,2336,1312,3360,800,2848,1824,3872
    DW   160,2208,1184,3232,672,2720,1696,3744
    DW   416,2464,1440,3488,928,2976,1952,4000
    DW   96,2144,1120,3168,608,2656,1632,3680
    DW   352,2400,1376,3424,864,2912,1888,3936
    DW   224,2272,1248,3296,736,2784,1760,3808
    DW   480,2528,1504,3552,992,3040,2016,4064
;
    DW   16,2064,1040,3088,528,2576,1552,3600
    DW   272,2320,1296,3344,784,2832,1808,3856
    DW   144,2192,1168,3216,656,2704,1680,3728
    DW   400,2448,1424,3472,912,2960,1936,3984
    DW   80,2128,1104,3152,592,2640,1616,3664
    DW   336,2384,1360,3408,848,2896,1872,3920
    DW   208,2256,1232,3280,720,2768,1744,3792
    DW   464,2512,1488,3536,976,3024,2000,4048
;
    DW   48,2096,1072,3120,560,2608,1584,3632
    DW   304,2352,1328,3376,816,2864,1840,3888
    DW   176,2224,1200,3248,688,2736,1712,3760
    DW   432,2480,1456,3504,944,2992,1968,4016
    DW   112,2160,1136,3184,624,2672,1648,3696
    DW   368,2416,1392,3440,880,2928,1904,3952
    DW   240,2288,1264,3312,752,2800,1776,3824
    DW   496,2544,1520,3568,1008,3056,2032,4080
;
    DW   8,2056,1032,3080,520,2568,1544,3592
    DW   264,2312,1288,3336,776,2824,1800,3848
    DW   136,2184,1160,3208,648,2696,1672,3720
    DW   392,2440,1416,3464,904,2952,1928,3976
    DW   72,2120,1096,3144,584,2632,1608,3656
    DW   328,2376,1352,3400,840,2888,1864,3912
    DW   200,2248,1224,3272,712,2760,1736,3784
    DW   456,2504,1480,3528,968,3016,1992,4040
;
    DW   40,2088,1064,3112,552,2600,1576,3624
    DW   296,2344,1320,3368,808,2856,1832,3880
    DW   168,2216,1192,3240,680,2728,1704,3752
    DW   424,2472,1448,3496,936,2984,1960,4008
    DW   104,2152,1128,3176,616,2664,1640,3688
    DW   360,2408,1384,3432,872,2920,1896,3944
    DW   232,2280,1256,3304,744,2792,1768,3816
    DW   488,2536,1512,3560,1000,3048,2024,4072
;
    DW   24,2072,1048,3096,536,2584,1560,3608
    DW   280,2328,1304,3352,792,2840,1816,3864
    DW   152,2200,1176,3224,664,2712,1688,3736
    DW   408,2456,1432,3480,920,2968,1944,3992
    DW   88,2136,1112,3160,600,2648,1624,3672
    DW   344,2392,1368,3416,856,2904,1880,3928
    DW   216,2264,1240,3288,728,2776,1752,3800
    DW   472,2520,1496,3544,984,3032,2008,4056
;
    DW   56,2104,1080,3128,568,2616,1592,3640
    DW   312,2360,1336,3384,824,2872,1848,3896
    DW   184,2232,1208,3256,696,2744,1720,3768
    DW   440,2488,1464,3512,952,3000,1976,4024
    DW   120,2168,1144,3192,632,2680,1656,3704
    DW   376,2424,1400,3448,888,2936,1912,3960
    DW   248,2296,1272,3320,760,2808,1784,3832
    DW   504,2552,1528,3576,1016,3064,2040,4088
;
    DW   4,2052,1028,3076,516,2564,1540,3588
    DW   260,2308,1284,3332,772,2820,1796,3844
    DW   132,2180,1156,3204,644,2692,1668,3716
    DW   388,2436,1412,3460,900,2948,1924,3972
    DW   68,2116,1092,3140,580,2628,1604,3652
    DW   324,2372,1348,3396,836,2884,1860,3908
    DW   196,2244,1220,3268,708,2756,1732,3780
    DW   452,2500,1476,3524,964,3012,1988,4036
;
    DW   36,2084,1060,3108,548,2596,1572,3620
    DW   292,2340,1316,3364,804,2852,1828,3876
    DW   164,2212,1188,3236,676,2724,1700,3748
    DW   420,2468,1444,3492,932,2980,1956,4004
    DW   100,2148,1124,3172,612,2660,1636,3684
    DW   356,2404,1380,3428,868,2916,1892,3940
    DW   228,2276,1252,3300,740,2788,1764,3812
    DW   484,2532,1508,3556,996,3044,2020,4068
;
    DW   20,2068,1044,3092,532,2580,1556,3604
    DW   276,2324,1300,3348,788,2836,1812,3860
    DW   148,2196,1172,3220,660,2708,1684,3732
    DW   404,2452,1428,3476,916,2964,1940,3988
    DW   84,2132,1108,3156,596,2644,1620,3668
    DW   340,2388,1364,3412,852,2900,1876,3924
    DW   212,2260,1236,3284,724,2772,1748,3796
    DW   468,2516,1492,3540,980,3028,2004,4052
;
    DW   52,2100,1076,3124,564,2612,1588,3636
    DW   308,2356,1332,3380,820,2868,1844,3892
    DW   180,2228,1204,3252,692,2740,1716,3764
    DW   436,2484,1460,3508,948,2996,1972,4020
    DW   116,2164,1140,3188,628,2676,1652,3700
    DW   372,2420,1396,3444,884,2932,1908,3956
    DW   244,2292,1268,3316,756,2804,1780,3828
    DW   500,2548,1524,3572,1012,3060,2036,4084
;
    DW   12,2060,1036,3084,524,2572,1548,3596
    DW   268,2316,1292,3340,780,2828,1804,3852
    DW   140,2188,1164,3212,652,2700,1676,3724
    DW   396,2444,1420,3468,908,2956,1932,3980
    DW   76,2124,1100,3148,588,2636,1612,3660
    DW   332,2380,1356,3404,844,2892,1868,3916
    DW   204,2252,1228,3276,716,2764,1740,3788
    DW   460,2508,1484,3532,972,3020,1996,4044
;
    DW   44,2092,1068,3116,556,2604,1580,3628
    DW   300,2348,1324,3372,812,2860,1836,3884
    DW   172,2220,1196,3244,684,2732,1708,3756
    DW   428,2476,1452,3500,940,2988,1964,4012
    DW   108,2156,1132,3180,620,2668,1644,3692
    DW   364,2412,1388,3436,876,2924,1900,3948
    DW   236,2284,1260,3308,748,2796,1772,3820
    DW   492,2540,1516,3564,1004,3052,2028,4076
;
    DW   28,2076,1052,3100,540,2588,1564,3612
    DW   284,2332,1308,3356,796,2844,1820,3868
    DW   156,2204,1180,3228,668,2716,1692,3740
    DW   412,2460,1436,3484,924,2972,1948,3996
    DW   92,2140,1116,3164,604,2652,1628,3676
    DW   348,2396,1372,3420,860,2908,1884,3932
    DW   220,2268,1244,3292,732,2780,1756,3804
    DW   476,2524,1500,3548,988,3036,2012,4060
;
    DW   60,2108,1084,3132,572,2620,1596,3644
    DW   316,2364,1340,3388,828,2876,1852,3900
    DW   188,2236,1212,3260,700,2748,1724,3772
    DW   444,2492,1468,3516,956,3004,1980,4028
    DW   124,2172,1148,3196,636,2684,1660,3708
    DW   380,2428,1404,3452,892,2940,1916,3964
    DW   252,2300,1276,3324,764,2812,1788,3836
    DW   508,2556,1532,3580,1020,3068,2044,4092
;
    DW   2,2050,1026,3074,514,2562,1538,3586
    DW   258,2306,1282,3330,770,2818,1794,3842
    DW   130,2178,1154,3202,642,2690,1666,3714
    DW   386,2434,1410,3458,898,2946,1922,3970
    DW   66,2114,1090,3138,578,2626,1602,3650
    DW   322,2370,1346,3394,834,2882,1858,3906
    DW   194,2242,1218,3266,706,2754,1730,3778
    DW   450,2498,1474,3522,962,3010,1986,4034
;
    DW   34,2082,1058,3106,546,2594,1570,3618
    DW   290,2338,1314,3362,802,2850,1826,3874
    DW   162,2210,1186,3234,674,2722,1698,3746
    DW   418,2466,1442,3490,930,2978,1954,4002
    DW   98,2146,1122,3170,610,2658,1634,3682
    DW   354,2402,1378,3426,866,2914,1890,3938
    DW   226,2274,1250,3298,738,2786,1762,3810
    DW   482,2530,1506,3554,994,3042,2018,4066
;
    DW   18,2066,1042,3090,530,2578,1554,3602
    DW   274,2322,1298,3346,786,2834,1810,3858
    DW   146,2194,1170,3218,658,2706,1682,3730
    DW   402,2450,1426,3474,914,2962,1938,3986
    DW   82,2130,1106,3154,594,2642,1618,3666
    DW   338,2386,1362,3410,850,2898,1874,3922
    DW   210,2258,1234,3282,722,2770,1746,3794
    DW   466,2514,1490,3538,978,3026,2002,4050
;
    DW   50,2098,1074,3122,562,2610,1586,3634
    DW   306,2354,1330,3378,818,2866,1842,3890
    DW   178,2226,1202,3250,690,2738,1714,3762
    DW   434,2482,1458,3506,946,2994,1970,4018
    DW   114,2162,1138,3186,626,2674,1650,3698
    DW   370,2418,1394,3442,882,2930,1906,3954
    DW   242,2290,1266,3314,754,2802,1778,3826
    DW   498,2546,1522,3570,1010,3058,2034,4082
;
    DW   10,2058,1034,3082,522,2570,1546,3594
    DW   266,2314,1290,3338,778,2826,1802,3850
    DW   138,2186,1162,3210,650,2698,1674,3722
    DW   394,2442,1418,3466,906,2954,1930,3978
    DW   74,2122,1098,3146,586,2634,1610,3658
    DW   330,2378,1354,3402,842,2890,1866,3914
    DW   202,2250,1226,3274,714,2762,1738,3786
    DW   458,2506,1482,3530,970,3018,1994,4042
;
    DW   42,2090,1066,3114,554,2602,1578,3626
    DW   298,2346,1322,3370,810,2858,1834,3882
    DW   170,2218,1194,3242,682,2730,1706,3754
    DW   426,2474,1450,3498,938,2986,1962,4010
    DW   106,2154,1130,3178,618,2666,1642,3690
    DW   362,2410,1386,3434,874,2922,1898,3946
    DW   234,2282,1258,3306,746,2794,1770,3818
    DW   490,2538,1514,3562,1002,3050,2026,4074
;
    DW   26,2074,1050,3098,538,2586,1562,3610
    DW   282,2330,1306,3354,794,2842,1818,3866
    DW   154,2202,1178,3226,666,2714,1690,3738
    DW   410,2458,1434,3482,922,2970,1946,3994
    DW   90,2138,1114,3162,602,2650,1626,3674
    DW   346,2394,1370,3418,858,2906,1882,3930
    DW   218,2266,1242,3290,730,2778,1754,3802
    DW   474,2522,1498,3546,986,3034,2010,4058
;
    DW   58,2106,1082,3130,570,2618,1594,3642
    DW   314,2362,1338,3386,826,2874,1850,3898
    DW   186,2234,1210,3258,698,2746,1722,3770
    DW   442,2490,1466,3514,954,3002,1978,4026
    DW   122,2170,1146,3194,634,2682,1658,3706
    DW   378,2426,1402,3450,890,2938,1914,3962
    DW   250,2298,1274,3322,762,2810,1786,3834
    DW   506,2554,1530,3578,1018,3066,2042,4090
;
    DW   6,2054,1030,3078,518,2566,1542,3590
    DW   262,2310,1286,3334,774,2822,1798,3846
    DW   134,2182,1158,3206,646,2694,1670,3718
    DW   390,2438,1414,3462,902,2950,1926,3974
    DW   70,2118,1094,3142,582,2630,1606,3654
    DW   326,2374,1350,3398,838,2886,1862,3910
    DW   198,2246,1222,3270,710,2758,1734,3782
    DW   454,2502,1478,3526,966,3014,1990,4038
;
    DW   38,2086,1062,3110,550,2598,1574,3622
    DW   294,2342,1318,3366,806,2854,1830,3878
    DW   166,2214,1190,3238,678,2726,1702,3750
    DW   422,2470,1446,3494,934,2982,1958,4006
    DW   102,2150,1126,3174,614,2662,1638,3686
    DW   358,2406,1382,3430,870,2918,1894,3942
    DW   230,2278,1254,3302,742,2790,1766,3814
    DW   486,2534,1510,3558,998,3046,2022,4070
;
    DW   22,2070,1046,3094,534,2582,1558,3606
    DW   278,2326,1302,3350,790,2838,1814,3862
    DW   150,2198,1174,3222,662,2710,1686,3734
    DW   406,2454,1430,3478,918,2966,1942,3990
    DW   86,2134,1110,3158,598,2646,1622,3670
    DW   342,2390,1366,3414,854,2902,1878,3926
    DW   214,2262,1238,3286,726,2774,1750,3798
    DW   470,2518,1494,3542,982,3030,2006,4054
;
    DW   54,2102,1078,3126,566,2614,1590,3638
    DW   310,2358,1334,3382,822,2870,1846,3894
    DW   182,2230,1206,3254,694,2742,1718,3766
    DW   438,2486,1462,3510,950,2998,1974,4022
    DW   118,2166,1142,3190,630,2678,1654,3702
    DW   374,2422,1398,3446,886,2934,1910,3958
    DW   246,2294,1270,3318,758,2806,1782,3830
    DW   502,2550,1526,3574,1014,3062,2038,4086
;
    DW   14,2062,1038,3086,526,2574,1550,3598
    DW   270,2318,1294,3342,782,2830,1806,3854
    DW   142,2190,1166,3214,654,2702,1678,3726
    DW   398,2446,1422,3470,910,2958,1934,3982
    DW   78,2126,1102,3150,590,2638,1614,3662
    DW   334,2382,1358,3406,846,2894,1870,3918
    DW   206,2254,1230,3278,718,2766,1742,3790
    DW   462,2510,1486,3534,974,3022,1998,4046
;
    DW   46,2094,1070,3118,558,2606,1582,3630
    DW   302,2350,1326,3374,814,2862,1838,3886
    DW   174,2222,1198,3246,686,2734,1710,3758
    DW   430,2478,1454,3502,942,2990,1966,4014
    DW   110,2158,1134,3182,622,2670,1646,3694
    DW   366,2414,1390,3438,878,2926,1902,3950
    DW   238,2286,1262,3310,750,2798,1774,3822
    DW   494,2542,1518,3566,1006,3054,2030,4078
;
    DW   30,2078,1054,3102,542,2590,1566,3614
    DW   286,2334,1310,3358,798,2846,1822,3870
    DW   158,2206,1182,3230,670,2718,1694,3742
    DW   414,2462,1438,3486,926,2974,1950,3998
    DW   94,2142,1118,3166,606,2654,1630,3678
    DW   350,2398,1374,3422,862,2910,1886,3934
    DW   222,2270,1246,3294,734,2782,1758,3806
    DW   478,2526,1502,3550,990,3038,2014,4062
;
    DW   62,2110,1086,3134,574,2622,1598,3646
    DW   318,2366,1342,3390,830,2878,1854,3902
    DW   190,2238,1214,3262,702,2750,1726,3774
    DW   446,2494,1470,3518,958,3006,1982,4030
    DW   126,2174,1150,3198,638,2686,1662,3710
    DW   382,2430,1406,3454,894,2942,1918,3966
    DW   254,2302,1278,3326,766,2814,1790,3838
    DW   510,2558,1534,3582,1022,3070,2046,4094
;
    DW   1,2049,1025,3073,513,2561,1537,3585
    DW   257,2305,1281,3329,769,2817,1793,3841
    DW   129,2177,1153,3201,641,2689,1665,3713
    DW   385,2433,1409,3457,897,2945,1921,3969
    DW   65,2113,1089,3137,577,2625,1601,3649
    DW   321,2369,1345,3393,833,2881,1857,3905
    DW   193,2241,1217,3265,705,2753,1729,3777
    DW   449,2497,1473,3521,961,3009,1985,4033
;
    DW   33,2081,1057,3105,545,2593,1569,3617
    DW   289,2337,1313,3361,801,2849,1825,3873
    DW   161,2209,1185,3233,673,2721,1697,3745
    DW   417,2465,1441,3489,929,2977,1953,4001
    DW   97,2145,1121,3169,609,2657,1633,3681
    DW   353,2401,1377,3425,865,2913,1889,3937
    DW   225,2273,1249,3297,737,2785,1761,3809
    DW   481,2529,1505,3553,993,3041,2017,4065
;
    DW   17,2065,1041,3089,529,2577,1553,3601
    DW   273,2321,1297,3345,785,2833,1809,3857
    DW   145,2193,1169,3217,657,2705,1681,3729
    DW   401,2449,1425,3473,913,2961,1937,3985
    DW   81,2129,1105,3153,593,2641,1617,3665
    DW   337,2385,1361,3409,849,2897,1873,3921
    DW   209,2257,1233,3281,721,2769,1745,3793
    DW   465,2513,1489,3537,977,3025,2001,4049
;
    DW   49,2097,1073,3121,561,2609,1585,3633
    DW   305,2353,1329,3377,817,2865,1841,3889
    DW   177,2225,1201,3249,689,2737,1713,3761
    DW   433,2481,1457,3505,945,2993,1969,4017
    DW   113,2161,1137,3185,625,2673,1649,3697
    DW   369,2417,1393,3441,881,2929,1905,3953
    DW   241,2289,1265,3313,753,2801,1777,3825
    DW   497,2545,1521,3569,1009,3057,2033,4081
;
    DW   9,2057,1033,3081,521,2569,1545,3593
    DW   265,2313,1289,3337,777,2825,1801,3849
    DW   137,2185,1161,3209,649,2697,1673,3721
    DW   393,2441,1417,3465,905,2953,1929,3977
    DW   73,2121,1097,3145,585,2633,1609,3657
    DW   329,2377,1353,3401,841,2889,1865,3913
    DW   201,2249,1225,3273,713,2761,1737,3785
    DW   457,2505,1481,3529,969,3017,1993,4041
;
    DW   41,2089,1065,3113,553,2601,1577,3625
    DW   297,2345,1321,3369,809,2857,1833,3881
    DW   169,2217,1193,3241,681,2729,1705,3753
    DW   425,2473,1449,3497,937,2985,1961,4009
    DW   105,2153,1129,3177,617,2665,1641,3689
    DW   361,2409,1385,3433,873,2921,1897,3945
    DW   233,2281,1257,3305,745,2793,1769,3817
    DW   489,2537,1513,3561,1001,3049,2025,4073
;
    DW   25,2073,1049,3097,537,2585,1561,3609
    DW   281,2329,1305,3353,793,2841,1817,3865
    DW   153,2201,1177,3225,665,2713,1689,3737
    DW   409,2457,1433,3481,921,2969,1945,3993
    DW   89,2137,1113,3161,601,2649,1625,3673
    DW   345,2393,1369,3417,857,2905,1881,3929
    DW   217,2265,1241,3289,729,2777,1753,3801
    DW   473,2521,1497,3545,985,3033,2009,4057
;
    DW   57,2105,1081,3129,569,2617,1593,3641
    DW   313,2361,1337,3385,825,2873,1849,3897
    DW   185,2233,1209,3257,697,2745,1721,3769
    DW   441,2489,1465,3513,953,3001,1977,4025
    DW   121,2169,1145,3193,633,2681,1657,3705
    DW   377,2425,1401,3449,889,2937,1913,3961
    DW   249,2297,1273,3321,761,2809,1785,3833
    DW   505,2553,1529,3577,1017,3065,2041,4089
;
    DW   5,2053,1029,3077,517,2565,1541,3589
    DW   261,2309,1285,3333,773,2821,1797,3845
    DW   133,2181,1157,3205,645,2693,1669,3717
    DW   389,2437,1413,3461,901,2949,1925,3973
    DW   69,2117,1093,3141,581,2629,1605,3653
    DW   325,2373,1349,3397,837,2885,1861,3909
    DW   197,2245,1221,3269,709,2757,1733,3781
    DW   453,2501,1477,3525,965,3013,1989,4037
;
    DW   37,2085,1061,3109,549,2597,1573,3621
    DW   293,2341,1317,3365,805,2853,1829,3877
    DW   165,2213,1189,3237,677,2725,1701,3749
    DW   421,2469,1445,3493,933,2981,1957,4005
    DW   101,2149,1125,3173,613,2661,1637,3685
    DW   357,2405,1381,3429,869,2917,1893,3941
    DW   229,2277,1253,3301,741,2789,1765,3813
    DW   485,2533,1509,3557,997,3045,2021,4069
;
    DW   21,2069,1045,3093,533,2581,1557,3605
    DW   277,2325,1301,3349,789,2837,1813,3861
    DW   149,2197,1173,3221,661,2709,1685,3733
    DW   405,2453,1429,3477,917,2965,1941,3989
    DW   85,2133,1109,3157,597,2645,1621,3669
    DW   341,2389,1365,3413,853,2901,1877,3925
    DW   213,2261,1237,3285,725,2773,1749,3797
    DW   469,2517,1493,3541,981,3029,2005,4053
;
    DW   53,2101,1077,3125,565,2613,1589,3637
    DW   309,2357,1333,3381,821,2869,1845,3893
    DW   181,2229,1205,3253,693,2741,1717,3765
    DW   437,2485,1461,3509,949,2997,1973,4021
    DW   117,2165,1141,3189,629,2677,1653,3701
    DW   373,2421,1397,3445,885,2933,1909,3957
    DW   245,2293,1269,3317,757,2805,1781,3829
    DW   501,2549,1525,3573,1013,3061,2037,4085
;
    DW   13,2061,1037,3085,525,2573,1549,3597
    DW   269,2317,1293,3341,781,2829,1805,3853
    DW   141,2189,1165,3213,653,2701,1677,3725
    DW   397,2445,1421,3469,909,2957,1933,3981
    DW   77,2125,1101,3149,589,2637,1613,3661
    DW   333,2381,1357,3405,845,2893,1869,3917
    DW   205,2253,1229,3277,717,2765,1741,3789
    DW   461,2509,1485,3533,973,3021,1997,4045
;
    DW   45,2093,1069,3117,557,2605,1581,3629
    DW   301,2349,1325,3373,813,2861,1837,3885
    DW   173,2221,1197,3245,685,2733,1709,3757
    DW   429,2477,1453,3501,941,2989,1965,4013
    DW   109,2157,1133,3181,621,2669,1645,3693
    DW   365,2413,1389,3437,877,2925,1901,3949
    DW   237,2285,1261,3309,749,2797,1773,3821
    DW   493,2541,1517,3565,1005,3053,2029,4077
;
    DW   29,2077,1053,3101,541,2589,1565,3613
    DW   285,2333,1309,3357,797,2845,1821,3869
    DW   157,2205,1181,3229,669,2717,1693,3741
    DW   413,2461,1437,3485,925,2973,1949,3997
    DW   93,2141,1117,3165,605,2653,1629,3677
    DW   349,2397,1373,3421,861,2909,1885,3933
    DW   221,2269,1245,3293,733,2781,1757,3805
    DW   477,2525,1501,3549,989,3037,2013,4061
;
    DW   61,2109,1085,3133,573,2621,1597,3645
    DW   317,2365,1341,3389,829,2877,1853,3901
    DW   189,2237,1213,3261,701,2749,1725,3773
    DW   445,2493,1469,3517,957,3005,1981,4029
    DW   125,2173,1149,3197,637,2685,1661,3709
    DW   381,2429,1405,3453,893,2941,1917,3965
    DW   253,2301,1277,3325,765,2813,1789,3837
    DW   509,2557,1533,3581,1021,3069,2045,4093
;
    DW   3,2051,1027,3075,515,2563,1539,3587
    DW   259,2307,1283,3331,771,2819,1795,3843
    DW   131,2179,1155,3203,643,2691,1667,3715
    DW   387,2435,1411,3459,899,2947,1923,3971
    DW   67,2115,1091,3139,579,2627,1603,3651
    DW   323,2371,1347,3395,835,2883,1859,3907
    DW   195,2243,1219,3267,707,2755,1731,3779
    DW   451,2499,1475,3523,963,3011,1987,4035
;
    DW   35,2083,1059,3107,547,2595,1571,3619
    DW   291,2339,1315,3363,803,2851,1827,3875
    DW   163,2211,1187,3235,675,2723,1699,3747
    DW   419,2467,1443,3491,931,2979,1955,4003
    DW   99,2147,1123,3171,611,2659,1635,3683
    DW   355,2403,1379,3427,867,2915,1891,3939
    DW   227,2275,1251,3299,739,2787,1763,3811
    DW   483,2531,1507,3555,995,3043,2019,4067
;
    DW   19,2067,1043,3091,531,2579,1555,3603
    DW   275,2323,1299,3347,787,2835,1811,3859
    DW   147,2195,1171,3219,659,2707,1683,3731
    DW   403,2451,1427,3475,915,2963,1939,3987
    DW   83,2131,1107,3155,595,2643,1619,3667
    DW   339,2387,1363,3411,851,2899,1875,3923
    DW   211,2259,1235,3283,723,2771,1747,3795
    DW   467,2515,1491,3539,979,3027,2003,4051
;
    DW   51,2099,1075,3123,563,2611,1587,3635
    DW   307,2355,1331,3379,819,2867,1843,3891
    DW   179,2227,1203,3251,691,2739,1715,3763
    DW   435,2483,1459,3507,947,2995,1971,4019
    DW   115,2163,1139,3187,627,2675,1651,3699
    DW   371,2419,1395,3443,883,2931,1907,3955
    DW   243,2291,1267,3315,755,2803,1779,3827
    DW   499,2547,1523,3571,1011,3059,2035,4083
;
    DW   11,2059,1035,3083,523,2571,1547,3595
    DW   267,2315,1291,3339,779,2827,1803,3851
    DW   139,2187,1163,3211,651,2699,1675,3723
    DW   395,2443,1419,3467,907,2955,1931,3979
    DW   75,2123,1099,3147,587,2635,1611,3659
    DW   331,2379,1355,3403,843,2891,1867,3915
    DW   203,2251,1227,3275,715,2763,1739,3787
    DW   459,2507,1483,3531,971,3019,1995,4043
;
    DW   43,2091,1067,3115,555,2603,1579,3627
    DW   299,2347,1323,3371,811,2859,1835,3883
    DW   171,2219,1195,3243,683,2731,1707,3755
    DW   427,2475,1451,3499,939,2987,1963,4011
    DW   107,2155,1131,3179,619,2667,1643,3691
    DW   363,2411,1387,3435,875,2923,1899,3947
    DW   235,2283,1259,3307,747,2795,1771,3819
    DW   491,2539,1515,3563,1003,3051,2027,4075
;
    DW   27,2075,1051,3099,539,2587,1563,3611
    DW   283,2331,1307,3355,795,2843,1819,3867
    DW   155,2203,1179,3227,667,2715,1691,3739
    DW   411,2459,1435,3483,923,2971,1947,3995
    DW   91,2139,1115,3163,603,2651,1627,3675
    DW   347,2395,1371,3419,859,2907,1883,3931
    DW   219,2267,1243,3291,731,2779,1755,3803
    DW   475,2523,1499,3547,987,3035,2011,4059
;
    DW   59,2107,1083,3131,571,2619,1595,3643
    DW   315,2363,1339,3387,827,2875,1851,3899
    DW   187,2235,1211,3259,699,2747,1723,3771
    DW   443,2491,1467,3515,955,3003,1979,4027
    DW   123,2171,1147,3195,635,2683,1659,3707
    DW   379,2427,1403,3451,891,2939,1915,3963
    DW   251,2299,1275,3323,763,2811,1787,3835
    DW   507,2555,1531,3579,1019,3067,2043,4091
;
    DW   7,2055,1031,3079,519,2567,1543,3591
    DW   263,2311,1287,3335,775,2823,1799,3847
    DW   135,2183,1159,3207,647,2695,1671,3719
    DW   391,2439,1415,3463,903,2951,1927,3975
    DW   71,2119,1095,3143,583,2631,1607,3655
    DW   327,2375,1351,3399,839,2887,1863,3911
    DW   199,2247,1223,3271,711,2759,1735,3783
    DW   455,2503,1479,3527,967,3015,1991,4039
;
    DW   39,2087,1063,3111,551,2599,1575,3623
    DW   295,2343,1319,3367,807,2855,1831,3879
    DW   167,2215,1191,3239,679,2727,1703,3751
    DW   423,2471,1447,3495,935,2983,1959,4007
    DW   103,2151,1127,3175,615,2663,1639,3687
    DW   359,2407,1383,3431,871,2919,1895,3943
    DW   231,2279,1255,3303,743,2791,1767,3815
    DW   487,2535,1511,3559,999,3047,2023,4071
;
    DW   23,2071,1047,3095,535,2583,1559,3607
    DW   279,2327,1303,3351,791,2839,1815,3863
    DW   151,2199,1175,3223,663,2711,1687,3735
    DW   407,2455,1431,3479,919,2967,1943,3991
    DW   87,2135,1111,3159,599,2647,1623,3671
    DW   343,2391,1367,3415,855,2903,1879,3927
    DW   215,2263,1239,3287,727,2775,1751,3799
    DW   471,2519,1495,3543,983,3031,2007,4055
;
    DW   55,2103,1079,3127,567,2615,1591,3639
    DW   311,2359,1335,3383,823,2871,1847,3895
    DW   183,2231,1207,3255,695,2743,1719,3767
    DW   439,2487,1463,3511,951,2999,1975,4023
    DW   119,2167,1143,3191,631,2679,1655,3703
    DW   375,2423,1399,3447,887,2935,1911,3959
    DW   247,2295,1271,3319,759,2807,1783,3831
    DW   503,2551,1527,3575,1015,3063,2039,4087
;
    DW   15,2063,1039,3087,527,2575,1551,3599
    DW   271,2319,1295,3343,783,2831,1807,3855
    DW   143,2191,1167,3215,655,2703,1679,3727
    DW   399,2447,1423,3471,911,2959,1935,3983
    DW   79,2127,1103,3151,591,2639,1615,3663
    DW   335,2383,1359,3407,847,2895,1871,3919
    DW   207,2255,1231,3279,719,2767,1743,3791
    DW   463,2511,1487,3535,975,3023,1999,4047
;
    DW   47,2095,1071,3119,559,2607,1583,3631
    DW   303,2351,1327,3375,815,2863,1839,3887
    DW   175,2223,1199,3247,687,2735,1711,3759
    DW   431,2479,1455,3503,943,2991,1967,4015
    DW   111,2159,1135,3183,623,2671,1647,3695
    DW   367,2415,1391,3439,879,2927,1903,3951
    DW   239,2287,1263,3311,751,2799,1775,3823
    DW   495,2543,1519,3567,1007,3055,2031,4079
;
    DW   31,2079,1055,3103,543,2591,1567,3615
    DW   287,2335,1311,3359,799,2847,1823,3871
    DW   159,2207,1183,3231,671,2719,1695,3743
    DW   415,2463,1439,3487,927,2975,1951,3999
    DW   95,2143,1119,3167,607,2655,1631,3679
    DW   351,2399,1375,3423,863,2911,1887,3935
    DW   223,2271,1247,3295,735,2783,1759,3807
    DW   479,2527,1503,3551,991,3039,2015,4063
;
    DW   63,2111,1087,3135,575,2623,1599,3647
    DW   319,2367,1343,3391,831,2879,1855,3903
    DW   191,2239,1215,3263,703,2751,1727,3775
    DW   447,2495,1471,3519,959,3007,1983,4031
    DW   127,2175,1151,3199,639,2687,1663,3711
    DW   383,2431,1407,3455,895,2943,1919,3967
    DW   255,2303,1279,3327,767,2815,1791,3839
    DW   511,2559,1535,3583,1023,3071,2047,4095
;
; Tables for controlling X => X^2
;
; X(0)      = X(0)^2, 
; X(D-b(k)) = X(k)^2,  k = 1, 2, ..., D-1
;
; Cycle structure and table for D = 4096
;
TqC DW   Li4
    DW   0,Li4 ; c = 1 
    DW   1,2048,4095,Li4 ; c = 3 
    DW   2,3072,4093,1025,2046,2050,3071,3,1024,4094,2049,2047,Li4 ; c = 12 
    DW   4,3584,4089,1537,2042,2562,3067,515,1020,3076,3581,1029 
    DW   1534,2054,2559,7,512,4092,3073,2045,1026,3070,2051,1023,Li4 ; c = 24 
    DW   5,1536,4090,2561,2043,514,3068,3075,1021,1028,3582,2053 
    DW   1535,6,2560,4091,513,2044,3074,3069,1027,1022,2052,3583,Li4 ; c = 24 
;
    DW   8,3840,4081,1793,2034,2818,3059,771,1012,3332,3573,1285 
    DW   1526,2310,2551,263,504,3592,3833,1545,1786,2570,2811,523 
    DW   764,3084,3325,1037,1278,2062,2303,15,256,4088,3585,2041 
    DW   1538,3066,2563,1019,516,3580,3077,1533,1030,2558,2055,511,Li4 ; c = 48 
;
    DW   9,1792,4082,2817,2035,770,3060,3331,1013,1284,3574,2309 
    DW   1527,262,2552,3591,505,1544,3834,2569,1787,522,2812,3083 
    DW   765,1036,3326,2061,1279,14,2304,4087,257,2040,3586,3065 
    DW   1539,1018,2564,3579,517,1532,3078,2557,1031,510,2056,3839,Li4 ; c = 48 
;
    DW   10,2816,4083,769,2036,3330,3061,1283,1014,2308,3575,261 
    DW   1528,3590,2553,1543,506,2568,3835,521,1788,3082,2813,1035 
    DW   766,2060,3327,13,1280,4086,2305,2039,258,3064,3587,1017 
    DW   1540,3578,2565,1531,518,2556,3079,509,1032,3838,2057,1791,Li4 ; c = 48 
;
    DW   11,768,4084,3329,2037,1282,3062,2307,1015,260,3576,3589 
    DW   1529,1542,2554,2567,507,520,3836,3081,1789,1034,2814,2059 
    DW   767,12,3328,4085,1281,2038,2306,3063,259,1016,3588,3577 
    DW   1541,1530,2566,2555,519,508,3080,3837,1033,1790,2058,2815,Li4 ; c = 48 
;
    DW   16,3968,4065,1921,2018,2946,3043,899,996,3460,3557,1413 
    DW   1510,2438,2535,391,488,3720,3817,1673,1770,2698,2795,651 
    DW   748,3212,3309,1165,1262,2190,2287,143,240,3856,3953,1809 
    DW   1906,2834,2931,787,884,3348,3445,1301,1398,2326,2423,279 
    DW   376,3608,3705,1561,1658,2586,2683,539,636,3100,3197,1053 
    DW   1150,2078,2175,31,128,4080,3841,2033,1794,3058,2819,1011 
    DW   772,3572,3333,1525,1286,2550,2311,503,264,3832,3593,1785 
    DW   1546,2810,2571,763,524,3324,3085,1277,1038,2302,2063,255,Li4 ; c = 96 
;
    DW   17,1920,4066,2945,2019,898,3044,3459,997,1412,3558,2437 
    DW   1511,390,2536,3719,489,1672,3818,2697,1771,650,2796,3211 
    DW   749,1164,3310,2189,1263,142,2288,3855,241,1808,3954,2833 
    DW   1907,786,2932,3347,885,1300,3446,2325,1399,278,2424,3607 
    DW   377,1560,3706,2585,1659,538,2684,3099,637,1052,3198,2077 
    DW   1151,30,2176,4079,129,2032,3842,3057,1795,1010,2820,3571 
    DW   773,1524,3334,2549,1287,502,2312,3831,265,1784,3594,2809 
    DW   1547,762,2572,3323,525,1276,3086,2301,1039,254,2064,3967,Li4 ; c = 96 
;
    DW   18,2944,4067,897,2020,3458,3045,1411,998,2436,3559,389 
    DW   1512,3718,2537,1671,490,2696,3819,649,1772,3210,2797,1163 
    DW   750,2188,3311,141,1264,3854,2289,1807,242,2832,3955,785 
    DW   1908,3346,2933,1299,886,2324,3447,277,1400,3606,2425,1559 
    DW   378,2584,3707,537,1660,3098,2685,1051,638,2076,3199,29 
    DW   1152,4078,2177,2031,130,3056,3843,1009,1796,3570,2821,1523 
    DW   774,2548,3335,501,1288,3830,2313,1783,266,2808,3595,761 
    DW   1548,3322,2573,1275,526,2300,3087,253,1040,3966,2065,1919,Li4 ; c = 96 
;
    DW   19,896,4068,3457,2021,1410,3046,2435,999,388,3560,3717 
    DW   1513,1670,2538,2695,491,648,3820,3209,1773,1162,2798,2187 
    DW   751,140,3312,3853,1265,1806,2290,2831,243,784,3956,3345 
    DW   1909,1298,2934,2323,887,276,3448,3605,1401,1558,2426,2583 
    DW   379,536,3708,3097,1661,1050,2686,2075,639,28,3200,4077 
    DW   1153,2030,2178,3055,131,1008,3844,3569,1797,1522,2822,2547 
    DW   775,500,3336,3829,1289,1782,2314,2807,267,760,3596,3321 
    DW   1549,1274,2574,2299,527,252,3088,3965,1041,1918,2066,2943,Li4 ; c = 96 
;
    DW   20,3456,4069,1409,2022,2434,3047,387,1000,3716,3561,1669 
    DW   1514,2694,2539,647,492,3208,3821,1161,1774,2186,2799,139 
    DW   752,3852,3313,1805,1266,2830,2291,783,244,3344,3957,1297 
    DW   1910,2322,2935,275,888,3604,3449,1557,1402,2582,2427,535 
    DW   380,3096,3709,1049,1662,2074,2687,27,640,4076,3201,2029 
    DW   1154,3054,2179,1007,132,3568,3845,1521,1798,2546,2823,499 
    DW   776,3828,3337,1781,1290,2806,2315,759,268,3320,3597,1273 
    DW   1550,2298,2575,251,528,3964,3089,1917,1042,2942,2067,895,Li4 ; c = 96 
;
    DW   21,1408,4070,2433,2023,386,3048,3715,1001,1668,3562,2693 
    DW   1515,646,2540,3207,493,1160,3822,2185,1775,138,2800,3851 
    DW   753,1804,3314,2829,1267,782,2292,3343,245,1296,3958,2321 
    DW   1911,274,2936,3603,889,1556,3450,2581,1403,534,2428,3095 
    DW   381,1048,3710,2073,1663,26,2688,4075,641,2028,3202,3053 
    DW   1155,1006,2180,3567,133,1520,3846,2545,1799,498,2824,3827 
    DW   777,1780,3338,2805,1291,758,2316,3319,269,1272,3598,2297 
    DW   1551,250,2576,3963,529,1916,3090,2941,1043,894,2068,3455,Li4 ; c = 96 
;
    DW   22,2432,4071,385,2024,3714,3049,1667,1002,2692,3563,645 
    DW   1516,3206,2541,1159,494,2184,3823,137,1776,3850,2801,1803 
    DW   754,2828,3315,781,1268,3342,2293,1295,246,2320,3959,273 
    DW   1912,3602,2937,1555,890,2580,3451,533,1404,3094,2429,1047 
    DW   382,2072,3711,25,1664,4074,2689,2027,642,3052,3203,1005 
    DW   1156,3566,2181,1519,134,2544,3847,497,1800,3826,2825,1779 
    DW   778,2804,3339,757,1292,3318,2317,1271,270,2296,3599,249 
    DW   1552,3962,2577,1915,530,2940,3091,893,1044,3454,2069,1407,Li4 ; c = 96 
;
    DW   23,384,4072,3713,2025,1666,3050,2691,1003,644,3564,3205 
    DW   1517,1158,2542,2183,495,136,3824,3849,1777,1802,2802,2827 
    DW   755,780,3316,3341,1269,1294,2294,2319,247,272,3960,3601 
    DW   1913,1554,2938,2579,891,532,3452,3093,1405,1046,2430,2071 
    DW   383,24,3712,4073,1665,2026,2690,3051,643,1004,3204,3565 
    DW   1157,1518,2182,2543,135,496,3848,3825,1801,1778,2826,2803 
    DW   779,756,3340,3317,1293,1270,2318,2295,271,248,3600,3961 
    DW   1553,1914,2578,2939,531,892,3092,3453,1045,1406,2070,2431,Li4 ; c = 96 
;
    DW   32,4032,4033,1985,1986,3010,3011,963,964,3524,3525,1477 
    DW   1478,2502,2503,455,456,3784,3785,1737,1738,2762,2763,715 
    DW   716,3276,3277,1229,1230,2254,2255,207,208,3920,3921,1873 
    DW   1874,2898,2899,851,852,3412,3413,1365,1366,2390,2391,343 
    DW   344,3672,3673,1625,1626,2650,2651,603,604,3164,3165,1117 
    DW   1118,2142,2143,95,96,4000,4001,1953,1954,2978,2979,931 
    DW   932,3492,3493,1445,1446,2470,2471,423,424,3752,3753,1705 
    DW   1706,2730,2731,683,684,3244,3245,1197,1198,2222,2223,175 
    DW   176,3888,3889,1841,1842,2866,2867,819,820,3380,3381,1333 
    DW   1334,2358,2359,311,312,3640,3641,1593,1594,2618,2619,571 
    DW   572,3132,3133,1085,1086,2110,2111,63,64,4064,3969,2017 
    DW   1922,3042,2947,995,900,3556,3461,1509,1414,2534,2439,487 
    DW   392,3816,3721,1769,1674,2794,2699,747,652,3308,3213,1261 
    DW   1166,2286,2191,239,144,3952,3857,1905,1810,2930,2835,883 
    DW   788,3444,3349,1397,1302,2422,2327,375,280,3704,3609,1657 
    DW   1562,2682,2587,635,540,3196,3101,1149,1054,2174,2079,127,Li4 ; c = 192 
;
    DW   33,1984,4034,3009,1987,962,3012,3523,965,1476,3526,2501 
    DW   1479,454,2504,3783,457,1736,3786,2761,1739,714,2764,3275 
    DW   717,1228,3278,2253,1231,206,2256,3919,209,1872,3922,2897 
    DW   1875,850,2900,3411,853,1364,3414,2389,1367,342,2392,3671 
    DW   345,1624,3674,2649,1627,602,2652,3163,605,1116,3166,2141 
    DW   1119,94,2144,3999,97,1952,4002,2977,1955,930,2980,3491 
    DW   933,1444,3494,2469,1447,422,2472,3751,425,1704,3754,2729 
    DW   1707,682,2732,3243,685,1196,3246,2221,1199,174,2224,3887 
    DW   177,1840,3890,2865,1843,818,2868,3379,821,1332,3382,2357 
    DW   1335,310,2360,3639,313,1592,3642,2617,1595,570,2620,3131 
    DW   573,1084,3134,2109,1087,62,2112,4063,65,2016,3970,3041 
    DW   1923,994,2948,3555,901,1508,3462,2533,1415,486,2440,3815 
    DW   393,1768,3722,2793,1675,746,2700,3307,653,1260,3214,2285 
    DW   1167,238,2192,3951,145,1904,3858,2929,1811,882,2836,3443 
    DW   789,1396,3350,2421,1303,374,2328,3703,281,1656,3610,2681 
    DW   1563,634,2588,3195,541,1148,3102,2173,1055,126,2080,4031,Li4 ; c = 192 
;
    DW   34,3008,4035,961,1988,3522,3013,1475,966,2500,3527,453 
    DW   1480,3782,2505,1735,458,2760,3787,713,1740,3274,2765,1227 
    DW   718,2252,3279,205,1232,3918,2257,1871,210,2896,3923,849 
    DW   1876,3410,2901,1363,854,2388,3415,341,1368,3670,2393,1623 
    DW   346,2648,3675,601,1628,3162,2653,1115,606,2140,3167,93 
    DW   1120,3998,2145,1951,98,2976,4003,929,1956,3490,2981,1443 
    DW   934,2468,3495,421,1448,3750,2473,1703,426,2728,3755,681 
    DW   1708,3242,2733,1195,686,2220,3247,173,1200,3886,2225,1839 
    DW   178,2864,3891,817,1844,3378,2869,1331,822,2356,3383,309 
    DW   1336,3638,2361,1591,314,2616,3643,569,1596,3130,2621,1083 
    DW   574,2108,3135,61,1088,4062,2113,2015,66,3040,3971,993 
    DW   1924,3554,2949,1507,902,2532,3463,485,1416,3814,2441,1767 
    DW   394,2792,3723,745,1676,3306,2701,1259,654,2284,3215,237 
    DW   1168,3950,2193,1903,146,2928,3859,881,1812,3442,2837,1395 
    DW   790,2420,3351,373,1304,3702,2329,1655,282,2680,3611,633 
    DW   1564,3194,2589,1147,542,2172,3103,125,1056,4030,2081,1983,Li4 ; c = 192 
;
    DW   35,960,4036,3521,1989,1474,3014,2499,967,452,3528,3781 
    DW   1481,1734,2506,2759,459,712,3788,3273,1741,1226,2766,2251 
    DW   719,204,3280,3917,1233,1870,2258,2895,211,848,3924,3409 
    DW   1877,1362,2902,2387,855,340,3416,3669,1369,1622,2394,2647 
    DW   347,600,3676,3161,1629,1114,2654,2139,607,92,3168,3997 
    DW   1121,1950,2146,2975,99,928,4004,3489,1957,1442,2982,2467 
    DW   935,420,3496,3749,1449,1702,2474,2727,427,680,3756,3241 
    DW   1709,1194,2734,2219,687,172,3248,3885,1201,1838,2226,2863 
    DW   179,816,3892,3377,1845,1330,2870,2355,823,308,3384,3637 
    DW   1337,1590,2362,2615,315,568,3644,3129,1597,1082,2622,2107 
    DW   575,60,3136,4061,1089,2014,2114,3039,67,992,3972,3553 
    DW   1925,1506,2950,2531,903,484,3464,3813,1417,1766,2442,2791 
    DW   395,744,3724,3305,1677,1258,2702,2283,655,236,3216,3949 
    DW   1169,1902,2194,2927,147,880,3860,3441,1813,1394,2838,2419 
    DW   791,372,3352,3701,1305,1654,2330,2679,283,632,3612,3193 
    DW   1565,1146,2590,2171,543,124,3104,4029,1057,1982,2082,3007,Li4 ; c = 192 
;
    DW   36,3520,4037,1473,1990,2498,3015,451,968,3780,3529,1733 
    DW   1482,2758,2507,711,460,3272,3789,1225,1742,2250,2767,203 
    DW   720,3916,3281,1869,1234,2894,2259,847,212,3408,3925,1361 
    DW   1878,2386,2903,339,856,3668,3417,1621,1370,2646,2395,599 
    DW   348,3160,3677,1113,1630,2138,2655,91,608,3996,3169,1949 
    DW   1122,2974,2147,927,100,3488,4005,1441,1958,2466,2983,419 
    DW   936,3748,3497,1701,1450,2726,2475,679,428,3240,3757,1193 
    DW   1710,2218,2735,171,688,3884,3249,1837,1202,2862,2227,815 
    DW   180,3376,3893,1329,1846,2354,2871,307,824,3636,3385,1589 
    DW   1338,2614,2363,567,316,3128,3645,1081,1598,2106,2623,59 
    DW   576,4060,3137,2013,1090,3038,2115,991,68,3552,3973,1505 
    DW   1926,2530,2951,483,904,3812,3465,1765,1418,2790,2443,743 
    DW   396,3304,3725,1257,1678,2282,2703,235,656,3948,3217,1901 
    DW   1170,2926,2195,879,148,3440,3861,1393,1814,2418,2839,371 
    DW   792,3700,3353,1653,1306,2678,2331,631,284,3192,3613,1145 
    DW   1566,2170,2591,123,544,4028,3105,1981,1058,3006,2083,959,Li4 ; c = 192 
;
    DW   37,1472,4038,2497,1991,450,3016,3779,969,1732,3530,2757 
    DW   1483,710,2508,3271,461,1224,3790,2249,1743,202,2768,3915 
    DW   721,1868,3282,2893,1235,846,2260,3407,213,1360,3926,2385 
    DW   1879,338,2904,3667,857,1620,3418,2645,1371,598,2396,3159 
    DW   349,1112,3678,2137,1631,90,2656,3995,609,1948,3170,2973 
    DW   1123,926,2148,3487,101,1440,4006,2465,1959,418,2984,3747 
    DW   937,1700,3498,2725,1451,678,2476,3239,429,1192,3758,2217 
    DW   1711,170,2736,3883,689,1836,3250,2861,1203,814,2228,3375 
    DW   181,1328,3894,2353,1847,306,2872,3635,825,1588,3386,2613 
    DW   1339,566,2364,3127,317,1080,3646,2105,1599,58,2624,4059 
    DW   577,2012,3138,3037,1091,990,2116,3551,69,1504,3974,2529 
    DW   1927,482,2952,3811,905,1764,3466,2789,1419,742,2444,3303 
    DW   397,1256,3726,2281,1679,234,2704,3947,657,1900,3218,2925 
    DW   1171,878,2196,3439,149,1392,3862,2417,1815,370,2840,3699 
    DW   793,1652,3354,2677,1307,630,2332,3191,285,1144,3614,2169 
    DW   1567,122,2592,4027,545,1980,3106,3005,1059,958,2084,3519,Li4 ; c = 192 
;
    DW   38,2496,4039,449,1992,3778,3017,1731,970,2756,3531,709 
    DW   1484,3270,2509,1223,462,2248,3791,201,1744,3914,2769,1867 
    DW   722,2892,3283,845,1236,3406,2261,1359,214,2384,3927,337 
    DW   1880,3666,2905,1619,858,2644,3419,597,1372,3158,2397,1111 
    DW   350,2136,3679,89,1632,3994,2657,1947,610,2972,3171,925 
    DW   1124,3486,2149,1439,102,2464,4007,417,1960,3746,2985,1699 
    DW   938,2724,3499,677,1452,3238,2477,1191,430,2216,3759,169 
    DW   1712,3882,2737,1835,690,2860,3251,813,1204,3374,2229,1327 
    DW   182,2352,3895,305,1848,3634,2873,1587,826,2612,3387,565 
    DW   1340,3126,2365,1079,318,2104,3647,57,1600,4058,2625,2011 
    DW   578,3036,3139,989,1092,3550,2117,1503,70,2528,3975,481 
    DW   1928,3810,2953,1763,906,2788,3467,741,1420,3302,2445,1255 
    DW   398,2280,3727,233,1680,3946,2705,1899,658,2924,3219,877 
    DW   1172,3438,2197,1391,150,2416,3863,369,1816,3698,2841,1651 
    DW   794,2676,3355,629,1308,3190,2333,1143,286,2168,3615,121 
    DW   1568,4026,2593,1979,546,3004,3107,957,1060,3518,2085,1471,Li4 ; c = 192 
;
    DW   39,448,4040,3777,1993,1730,3018,2755,971,708,3532,3269 
    DW   1485,1222,2510,2247,463,200,3792,3913,1745,1866,2770,2891 
    DW   723,844,3284,3405,1237,1358,2262,2383,215,336,3928,3665 
    DW   1881,1618,2906,2643,859,596,3420,3157,1373,1110,2398,2135 
    DW   351,88,3680,3993,1633,1946,2658,2971,611,924,3172,3485 
    DW   1125,1438,2150,2463,103,416,4008,3745,1961,1698,2986,2723 
    DW   939,676,3500,3237,1453,1190,2478,2215,431,168,3760,3881 
    DW   1713,1834,2738,2859,691,812,3252,3373,1205,1326,2230,2351 
    DW   183,304,3896,3633,1849,1586,2874,2611,827,564,3388,3125 
    DW   1341,1078,2366,2103,319,56,3648,4057,1601,2010,2626,3035 
    DW   579,988,3140,3549,1093,1502,2118,2527,71,480,3976,3809 
    DW   1929,1762,2954,2787,907,740,3468,3301,1421,1254,2446,2279 
    DW   399,232,3728,3945,1681,1898,2706,2923,659,876,3220,3437 
    DW   1173,1390,2198,2415,151,368,3864,3697,1817,1650,2842,2675 
    DW   795,628,3356,3189,1309,1142,2334,2167,287,120,3616,4025 
    DW   1569,1978,2594,3003,547,956,3108,3517,1061,1470,2086,2495,Li4 ; c = 192 
;
    DW   40,3776,4041,1729,1994,2754,3019,707,972,3268,3533,1221 
    DW   1486,2246,2511,199,464,3912,3793,1865,1746,2890,2771,843 
    DW   724,3404,3285,1357,1238,2382,2263,335,216,3664,3929,1617 
    DW   1882,2642,2907,595,860,3156,3421,1109,1374,2134,2399,87 
    DW   352,3992,3681,1945,1634,2970,2659,923,612,3484,3173,1437 
    DW   1126,2462,2151,415,104,3744,4009,1697,1962,2722,2987,675 
    DW   940,3236,3501,1189,1454,2214,2479,167,432,3880,3761,1833 
    DW   1714,2858,2739,811,692,3372,3253,1325,1206,2350,2231,303 
    DW   184,3632,3897,1585,1850,2610,2875,563,828,3124,3389,1077 
    DW   1342,2102,2367,55,320,4056,3649,2009,1602,3034,2627,987 
    DW   580,3548,3141,1501,1094,2526,2119,479,72,3808,3977,1761 
    DW   1930,2786,2955,739,908,3300,3469,1253,1422,2278,2447,231 
    DW   400,3944,3729,1897,1682,2922,2707,875,660,3436,3221,1389 
    DW   1174,2414,2199,367,152,3696,3865,1649,1818,2674,2843,627 
    DW   796,3188,3357,1141,1310,2166,2335,119,288,4024,3617,1977 
    DW   1570,3002,2595,955,548,3516,3109,1469,1062,2494,2087,447,Li4 ; c = 192 
;
    DW   41,1728,4042,2753,1995,706,3020,3267,973,1220,3534,2245 
    DW   1487,198,2512,3911,465,1864,3794,2889,1747,842,2772,3403 
    DW   725,1356,3286,2381,1239,334,2264,3663,217,1616,3930,2641 
    DW   1883,594,2908,3155,861,1108,3422,2133,1375,86,2400,3991 
    DW   353,1944,3682,2969,1635,922,2660,3483,613,1436,3174,2461 
    DW   1127,414,2152,3743,105,1696,4010,2721,1963,674,2988,3235 
    DW   941,1188,3502,2213,1455,166,2480,3879,433,1832,3762,2857 
    DW   1715,810,2740,3371,693,1324,3254,2349,1207,302,2232,3631 
    DW   185,1584,3898,2609,1851,562,2876,3123,829,1076,3390,2101 
    DW   1343,54,2368,4055,321,2008,3650,3033,1603,986,2628,3547 
    DW   581,1500,3142,2525,1095,478,2120,3807,73,1760,3978,2785 
    DW   1931,738,2956,3299,909,1252,3470,2277,1423,230,2448,3943 
    DW   401,1896,3730,2921,1683,874,2708,3435,661,1388,3222,2413 
    DW   1175,366,2200,3695,153,1648,3866,2673,1819,626,2844,3187 
    DW   797,1140,3358,2165,1311,118,2336,4023,289,1976,3618,3001 
    DW   1571,954,2596,3515,549,1468,3110,2493,1063,446,2088,3775,Li4 ; c = 192 
;
    DW   42,2752,4043,705,1996,3266,3021,1219,974,2244,3535,197 
    DW   1488,3910,2513,1863,466,2888,3795,841,1748,3402,2773,1355 
    DW   726,2380,3287,333,1240,3662,2265,1615,218,2640,3931,593 
    DW   1884,3154,2909,1107,862,2132,3423,85,1376,3990,2401,1943 
    DW   354,2968,3683,921,1636,3482,2661,1435,614,2460,3175,413 
    DW   1128,3742,2153,1695,106,2720,4011,673,1964,3234,2989,1187 
    DW   942,2212,3503,165,1456,3878,2481,1831,434,2856,3763,809 
    DW   1716,3370,2741,1323,694,2348,3255,301,1208,3630,2233,1583 
    DW   186,2608,3899,561,1852,3122,2877,1075,830,2100,3391,53 
    DW   1344,4054,2369,2007,322,3032,3651,985,1604,3546,2629,1499 
    DW   582,2524,3143,477,1096,3806,2121,1759,74,2784,3979,737 
    DW   1932,3298,2957,1251,910,2276,3471,229,1424,3942,2449,1895 
    DW   402,2920,3731,873,1684,3434,2709,1387,662,2412,3223,365 
    DW   1176,3694,2201,1647,154,2672,3867,625,1820,3186,2845,1139 
    DW   798,2164,3359,117,1312,4022,2337,1975,290,3000,3619,953 
    DW   1572,3514,2597,1467,550,2492,3111,445,1064,3774,2089,1727,Li4 ; c = 192 
;
    DW   43,704,4044,3265,1997,1218,3022,2243,975,196,3536,3909 
    DW   1489,1862,2514,2887,467,840,3796,3401,1749,1354,2774,2379 
    DW   727,332,3288,3661,1241,1614,2266,2639,219,592,3932,3153 
    DW   1885,1106,2910,2131,863,84,3424,3989,1377,1942,2402,2967 
    DW   355,920,3684,3481,1637,1434,2662,2459,615,412,3176,3741 
    DW   1129,1694,2154,2719,107,672,4012,3233,1965,1186,2990,2211 
    DW   943,164,3504,3877,1457,1830,2482,2855,435,808,3764,3369 
    DW   1717,1322,2742,2347,695,300,3256,3629,1209,1582,2234,2607 
    DW   187,560,3900,3121,1853,1074,2878,2099,831,52,3392,4053 
    DW   1345,2006,2370,3031,323,984,3652,3545,1605,1498,2630,2523 
    DW   583,476,3144,3805,1097,1758,2122,2783,75,736,3980,3297 
    DW   1933,1250,2958,2275,911,228,3472,3941,1425,1894,2450,2919 
    DW   403,872,3732,3433,1685,1386,2710,2411,663,364,3224,3693 
    DW   1177,1646,2202,2671,155,624,3868,3185,1821,1138,2846,2163 
    DW   799,116,3360,4021,1313,1974,2338,2999,291,952,3620,3513 
    DW   1573,1466,2598,2491,551,444,3112,3773,1065,1726,2090,2751,Li4 ; c = 192 
;
    DW   44,3264,4045,1217,1998,2242,3023,195,976,3908,3537,1861 
    DW   1490,2886,2515,839,468,3400,3797,1353,1750,2378,2775,331 
    DW   728,3660,3289,1613,1242,2638,2267,591,220,3152,3933,1105 
    DW   1886,2130,2911,83,864,3988,3425,1941,1378,2966,2403,919 
    DW   356,3480,3685,1433,1638,2458,2663,411,616,3740,3177,1693 
    DW   1130,2718,2155,671,108,3232,4013,1185,1966,2210,2991,163 
    DW   944,3876,3505,1829,1458,2854,2483,807,436,3368,3765,1321 
    DW   1718,2346,2743,299,696,3628,3257,1581,1210,2606,2235,559 
    DW   188,3120,3901,1073,1854,2098,2879,51,832,4052,3393,2005 
    DW   1346,3030,2371,983,324,3544,3653,1497,1606,2522,2631,475 
    DW   584,3804,3145,1757,1098,2782,2123,735,76,3296,3981,1249 
    DW   1934,2274,2959,227,912,3940,3473,1893,1426,2918,2451,871 
    DW   404,3432,3733,1385,1686,2410,2711,363,664,3692,3225,1645 
    DW   1178,2670,2203,623,156,3184,3869,1137,1822,2162,2847,115 
    DW   800,4020,3361,1973,1314,2998,2339,951,292,3512,3621,1465 
    DW   1574,2490,2599,443,552,3772,3113,1725,1066,2750,2091,703,Li4 ; c = 192 
;
    DW   45,1216,4046,2241,1999,194,3024,3907,977,1860,3538,2885 
    DW   1491,838,2516,3399,469,1352,3798,2377,1751,330,2776,3659 
    DW   729,1612,3290,2637,1243,590,2268,3151,221,1104,3934,2129 
    DW   1887,82,2912,3987,865,1940,3426,2965,1379,918,2404,3479 
    DW   357,1432,3686,2457,1639,410,2664,3739,617,1692,3178,2717 
    DW   1131,670,2156,3231,109,1184,4014,2209,1967,162,2992,3875 
    DW   945,1828,3506,2853,1459,806,2484,3367,437,1320,3766,2345 
    DW   1719,298,2744,3627,697,1580,3258,2605,1211,558,2236,3119 
    DW   189,1072,3902,2097,1855,50,2880,4051,833,2004,3394,3029 
    DW   1347,982,2372,3543,325,1496,3654,2521,1607,474,2632,3803 
    DW   585,1756,3146,2781,1099,734,2124,3295,77,1248,3982,2273 
    DW   1935,226,2960,3939,913,1892,3474,2917,1427,870,2452,3431 
    DW   405,1384,3734,2409,1687,362,2712,3691,665,1644,3226,2669 
    DW   1179,622,2204,3183,157,1136,3870,2161,1823,114,2848,4019 
    DW   801,1972,3362,2997,1315,950,2340,3511,293,1464,3622,2489 
    DW   1575,442,2600,3771,553,1724,3114,2749,1067,702,2092,3263,Li4 ; c = 192 
;
    DW   46,2240,4047,193,2000,3906,3025,1859,978,2884,3539,837 
    DW   1492,3398,2517,1351,470,2376,3799,329,1752,3658,2777,1611 
    DW   730,2636,3291,589,1244,3150,2269,1103,222,2128,3935,81 
    DW   1888,3986,2913,1939,866,2964,3427,917,1380,3478,2405,1431 
    DW   358,2456,3687,409,1640,3738,2665,1691,618,2716,3179,669 
    DW   1132,3230,2157,1183,110,2208,4015,161,1968,3874,2993,1827 
    DW   946,2852,3507,805,1460,3366,2485,1319,438,2344,3767,297 
    DW   1720,3626,2745,1579,698,2604,3259,557,1212,3118,2237,1071 
    DW   190,2096,3903,49,1856,4050,2881,2003,834,3028,3395,981 
    DW   1348,3542,2373,1495,326,2520,3655,473,1608,3802,2633,1755 
    DW   586,2780,3147,733,1100,3294,2125,1247,78,2272,3983,225 
    DW   1936,3938,2961,1891,914,2916,3475,869,1428,3430,2453,1383 
    DW   406,2408,3735,361,1688,3690,2713,1643,666,2668,3227,621 
    DW   1180,3182,2205,1135,158,2160,3871,113,1824,4018,2849,1971 
    DW   802,2996,3363,949,1316,3510,2341,1463,294,2488,3623,441 
    DW   1576,3770,2601,1723,554,2748,3115,701,1068,3262,2093,1215,Li4 ; c = 192 
;
    DW   47,192,4048,3905,2001,1858,3026,2883,979,836,3540,3397 
    DW   1493,1350,2518,2375,471,328,3800,3657,1753,1610,2778,2635 
    DW   731,588,3292,3149,1245,1102,2270,2127,223,80,3936,3985 
    DW   1889,1938,2914,2963,867,916,3428,3477,1381,1430,2406,2455 
    DW   359,408,3688,3737,1641,1690,2666,2715,619,668,3180,3229 
    DW   1133,1182,2158,2207,111,160,4016,3873,1969,1826,2994,2851 
    DW   947,804,3508,3365,1461,1318,2486,2343,439,296,3768,3625 
    DW   1721,1578,2746,2603,699,556,3260,3117,1213,1070,2238,2095 
    DW   191,48,3904,4049,1857,2002,2882,3027,835,980,3396,3541 
    DW   1349,1494,2374,2519,327,472,3656,3801,1609,1754,2634,2779 
    DW   587,732,3148,3293,1101,1246,2126,2271,79,224,3984,3937 
    DW   1937,1890,2962,2915,915,868,3476,3429,1429,1382,2454,2407 
    DW   407,360,3736,3689,1689,1642,2714,2667,667,620,3228,3181 
    DW   1181,1134,2206,2159,159,112,3872,4017,1825,1970,2850,2995 
    DW   803,948,3364,3509,1317,1462,2342,2487,295,440,3624,3769 
    DW   1577,1722,2602,2747,555,700,3116,3261,1069,1214,2094,2239,Li4 ; c = 192 
;
; Cycle structure and table for D = 2048
;
TqB DW   Li4
    DW   0,Li4 ; c = 1 
    DW   2,2048,4094,Li4 ; c = 3 
    DW   4,3072,4090,1026,2044,2052,3070,6,1024,4092,2050,2046,Li4 ; c = 12 
    DW   8,3584,4082,1538,2036,2564,3062,518,1016,3080,3578,1034 
    DW   1532,2060,2558,14,512,4088,3074,2042,1028,3068,2054,1022,Li4 ; c = 24 
    DW   10,1536,4084,2562,2038,516,3064,3078,1018,1032,3580,2058 
    DW   1534,12,2560,4086,514,2040,3076,3066,1030,1020,2056,3582,Li4 ; c = 24 
;
    DW   16,3840,4066,1794,2020,2820,3046,774,1000,3336,3562,1290 
    DW   1516,2316,2542,270,496,3600,3826,1554,1780,2580,2806,534 
    DW   760,3096,3322,1050,1276,2076,2302,30,256,4080,3586,2034 
    DW   1540,3060,2566,1014,520,3576,3082,1530,1036,2556,2062,510,Li4 ; c = 48 
;
    DW   18,1792,4068,2818,2022,772,3048,3334,1002,1288,3564,2314 
    DW   1518,268,2544,3598,498,1552,3828,2578,1782,532,2808,3094 
    DW   762,1048,3324,2074,1278,28,2304,4078,258,2032,3588,3058 
    DW   1542,1012,2568,3574,522,1528,3084,2554,1038,508,2064,3838,Li4 ; c = 48 
;
    DW   20,2816,4070,770,2024,3332,3050,1286,1004,2312,3566,266 
    DW   1520,3596,2546,1550,500,2576,3830,530,1784,3092,2810,1046 
    DW   764,2072,3326,26,1280,4076,2306,2030,260,3056,3590,1010 
    DW   1544,3572,2570,1526,524,2552,3086,506,1040,3836,2066,1790,Li4 ; c = 48 
;
    DW   22,768,4072,3330,2026,1284,3052,2310,1006,264,3568,3594 
    DW   1522,1548,2548,2574,502,528,3832,3090,1786,1044,2812,2070 
    DW   766,24,3328,4074,1282,2028,2308,3054,262,1008,3592,3570 
    DW   1546,1524,2572,2550,526,504,3088,3834,1042,1788,2068,2814,Li4 ; c = 48 
;
    DW   32,3968,4034,1922,1988,2948,3014,902,968,3464,3530,1418 
    DW   1484,2444,2510,398,464,3728,3794,1682,1748,2708,2774,662 
    DW   728,3224,3290,1178,1244,2204,2270,158,224,3872,3938,1826 
    DW   1892,2852,2918,806,872,3368,3434,1322,1388,2348,2414,302 
    DW   368,3632,3698,1586,1652,2612,2678,566,632,3128,3194,1082 
    DW   1148,2108,2174,62,128,4064,3842,2018,1796,3044,2822,998 
    DW   776,3560,3338,1514,1292,2540,2318,494,272,3824,3602,1778 
    DW   1556,2804,2582,758,536,3320,3098,1274,1052,2300,2078,254,Li4 ; c = 96 
;
    DW   34,1920,4036,2946,1990,900,3016,3462,970,1416,3532,2442 
    DW   1486,396,2512,3726,466,1680,3796,2706,1750,660,2776,3222 
    DW   730,1176,3292,2202,1246,156,2272,3870,226,1824,3940,2850 
    DW   1894,804,2920,3366,874,1320,3436,2346,1390,300,2416,3630 
    DW   370,1584,3700,2610,1654,564,2680,3126,634,1080,3196,2106 
    DW   1150,60,2176,4062,130,2016,3844,3042,1798,996,2824,3558 
    DW   778,1512,3340,2538,1294,492,2320,3822,274,1776,3604,2802 
    DW   1558,756,2584,3318,538,1272,3100,2298,1054,252,2080,3966,Li4 ; c = 96 
;
    DW   36,2944,4038,898,1992,3460,3018,1414,972,2440,3534,394 
    DW   1488,3724,2514,1678,468,2704,3798,658,1752,3220,2778,1174 
    DW   732,2200,3294,154,1248,3868,2274,1822,228,2848,3942,802 
    DW   1896,3364,2922,1318,876,2344,3438,298,1392,3628,2418,1582 
    DW   372,2608,3702,562,1656,3124,2682,1078,636,2104,3198,58 
    DW   1152,4060,2178,2014,132,3040,3846,994,1800,3556,2826,1510 
    DW   780,2536,3342,490,1296,3820,2322,1774,276,2800,3606,754 
    DW   1560,3316,2586,1270,540,2296,3102,250,1056,3964,2082,1918,Li4 ; c = 96 
;
    DW   38,896,4040,3458,1994,1412,3020,2438,974,392,3536,3722 
    DW   1490,1676,2516,2702,470,656,3800,3218,1754,1172,2780,2198 
    DW   734,152,3296,3866,1250,1820,2276,2846,230,800,3944,3362 
    DW   1898,1316,2924,2342,878,296,3440,3626,1394,1580,2420,2606 
    DW   374,560,3704,3122,1658,1076,2684,2102,638,56,3200,4058 
    DW   1154,2012,2180,3038,134,992,3848,3554,1802,1508,2828,2534 
    DW   782,488,3344,3818,1298,1772,2324,2798,278,752,3608,3314 
    DW   1562,1268,2588,2294,542,248,3104,3962,1058,1916,2084,2942,Li4 ; c = 96 
;
    DW   40,3456,4042,1410,1996,2436,3022,390,976,3720,3538,1674 
    DW   1492,2700,2518,654,472,3216,3802,1170,1756,2196,2782,150 
    DW   736,3864,3298,1818,1252,2844,2278,798,232,3360,3946,1314 
    DW   1900,2340,2926,294,880,3624,3442,1578,1396,2604,2422,558 
    DW   376,3120,3706,1074,1660,2100,2686,54,640,4056,3202,2010 
    DW   1156,3036,2182,990,136,3552,3850,1506,1804,2532,2830,486 
    DW   784,3816,3346,1770,1300,2796,2326,750,280,3312,3610,1266 
    DW   1564,2292,2590,246,544,3960,3106,1914,1060,2940,2086,894,Li4 ; c = 96 
;
    DW   42,1408,4044,2434,1998,388,3024,3718,978,1672,3540,2698 
    DW   1494,652,2520,3214,474,1168,3804,2194,1758,148,2784,3862 
    DW   738,1816,3300,2842,1254,796,2280,3358,234,1312,3948,2338 
    DW   1902,292,2928,3622,882,1576,3444,2602,1398,556,2424,3118 
    DW   378,1072,3708,2098,1662,52,2688,4054,642,2008,3204,3034 
    DW   1158,988,2184,3550,138,1504,3852,2530,1806,484,2832,3814 
    DW   786,1768,3348,2794,1302,748,2328,3310,282,1264,3612,2290 
    DW   1566,244,2592,3958,546,1912,3108,2938,1062,892,2088,3454,Li4 ; c = 96 
;
    DW   44,2432,4046,386,2000,3716,3026,1670,980,2696,3542,650 
    DW   1496,3212,2522,1166,476,2192,3806,146,1760,3860,2786,1814 
    DW   740,2840,3302,794,1256,3356,2282,1310,236,2336,3950,290 
    DW   1904,3620,2930,1574,884,2600,3446,554,1400,3116,2426,1070 
    DW   380,2096,3710,50,1664,4052,2690,2006,644,3032,3206,986 
    DW   1160,3548,2186,1502,140,2528,3854,482,1808,3812,2834,1766 
    DW   788,2792,3350,746,1304,3308,2330,1262,284,2288,3614,242 
    DW   1568,3956,2594,1910,548,2936,3110,890,1064,3452,2090,1406,Li4 ; c = 96 
;
    DW   46,384,4048,3714,2002,1668,3028,2694,982,648,3544,3210 
    DW   1498,1164,2524,2190,478,144,3808,3858,1762,1812,2788,2838 
    DW   742,792,3304,3354,1258,1308,2284,2334,238,288,3952,3618 
    DW   1906,1572,2932,2598,886,552,3448,3114,1402,1068,2428,2094 
    DW   382,48,3712,4050,1666,2004,2692,3030,646,984,3208,3546 
    DW   1162,1500,2188,2526,142,480,3856,3810,1810,1764,2836,2790 
    DW   790,744,3352,3306,1306,1260,2332,2286,286,240,3616,3954 
    DW   1570,1908,2596,2934,550,888,3112,3450,1066,1404,2092,2430,Li4 ; c = 96 
;
    DW   64,4032,3970,1986,1924,3012,2950,966,904,3528,3466,1482 
    DW   1420,2508,2446,462,400,3792,3730,1746,1684,2772,2710,726 
    DW   664,3288,3226,1242,1180,2268,2206,222,160,3936,3874,1890 
    DW   1828,2916,2854,870,808,3432,3370,1386,1324,2412,2350,366 
    DW   304,3696,3634,1650,1588,2676,2614,630,568,3192,3130,1146 
    DW   1084,2172,2110,126,Li4 ; c = 64 
;
    DW   66,1984,3972,3010,1926,964,2952,3526,906,1480,3468,2506 
    DW   1422,460,2448,3790,402,1744,3732,2770,1686,724,2712,3286 
    DW   666,1240,3228,2266,1182,220,2208,3934,162,1888,3876,2914 
    DW   1830,868,2856,3430,810,1384,3372,2410,1326,364,2352,3694 
    DW   306,1648,3636,2674,1590,628,2616,3190,570,1144,3132,2170 
    DW   1086,124,2112,4030,Li4 ; c = 64 
;
    DW   68,3008,3974,962,1928,3524,2954,1478,908,2504,3470,458 
    DW   1424,3788,2450,1742,404,2768,3734,722,1688,3284,2714,1238 
    DW   668,2264,3230,218,1184,3932,2210,1886,164,2912,3878,866 
    DW   1832,3428,2858,1382,812,2408,3374,362,1328,3692,2354,1646 
    DW   308,2672,3638,626,1592,3188,2618,1142,572,2168,3134,122 
    DW   1088,4028,2114,1982,Li4 ; c = 64 
;
    DW   70,960,3976,3522,1930,1476,2956,2502,910,456,3472,3786 
    DW   1426,1740,2452,2766,406,720,3736,3282,1690,1236,2716,2262 
    DW   670,216,3232,3930,1186,1884,2212,2910,166,864,3880,3426 
    DW   1834,1380,2860,2406,814,360,3376,3690,1330,1644,2356,2670 
    DW   310,624,3640,3186,1594,1140,2620,2166,574,120,3136,4026 
    DW   1090,1980,2116,3006,Li4 ; c = 64 
;
    DW   72,3520,3978,1474,1932,2500,2958,454,912,3784,3474,1738 
    DW   1428,2764,2454,718,408,3280,3738,1234,1692,2260,2718,214 
    DW   672,3928,3234,1882,1188,2908,2214,862,168,3424,3882,1378 
    DW   1836,2404,2862,358,816,3688,3378,1642,1332,2668,2358,622 
    DW   312,3184,3642,1138,1596,2164,2622,118,576,4024,3138,1978 
    DW   1092,3004,2118,958,Li4 ; c = 64 
;
    DW   74,1472,3980,2498,1934,452,2960,3782,914,1736,3476,2762 
    DW   1430,716,2456,3278,410,1232,3740,2258,1694,212,2720,3926 
    DW   674,1880,3236,2906,1190,860,2216,3422,170,1376,3884,2402 
    DW   1838,356,2864,3686,818,1640,3380,2666,1334,620,2360,3182 
    DW   314,1136,3644,2162,1598,116,2624,4022,578,1976,3140,3002 
    DW   1094,956,2120,3518,Li4 ; c = 64 
;
    DW   76,2496,3982,450,1936,3780,2962,1734,916,2760,3478,714 
    DW   1432,3276,2458,1230,412,2256,3742,210,1696,3924,2722,1878 
    DW   676,2904,3238,858,1192,3420,2218,1374,172,2400,3886,354 
    DW   1840,3684,2866,1638,820,2664,3382,618,1336,3180,2362,1134 
    DW   316,2160,3646,114,1600,4020,2626,1974,580,3000,3142,954 
    DW   1096,3516,2122,1470,Li4 ; c = 64 
;
    DW   78,448,3984,3778,1938,1732,2964,2758,918,712,3480,3274 
    DW   1434,1228,2460,2254,414,208,3744,3922,1698,1876,2724,2902 
    DW   678,856,3240,3418,1194,1372,2220,2398,174,352,3888,3682 
    DW   1842,1636,2868,2662,822,616,3384,3178,1338,1132,2364,2158 
    DW   318,112,3648,4018,1602,1972,2628,2998,582,952,3144,3514 
    DW   1098,1468,2124,2494,Li4 ; c = 64 
;
    DW   80,3776,3986,1730,1940,2756,2966,710,920,3272,3482,1226 
    DW   1436,2252,2462,206,416,3920,3746,1874,1700,2900,2726,854 
    DW   680,3416,3242,1370,1196,2396,2222,350,176,3680,3890,1634 
    DW   1844,2660,2870,614,824,3176,3386,1130,1340,2156,2366,110 
    DW   320,4016,3650,1970,1604,2996,2630,950,584,3512,3146,1466 
    DW   1100,2492,2126,446,Li4 ; c = 64 
;
    DW   82,1728,3988,2754,1942,708,2968,3270,922,1224,3484,2250 
    DW   1438,204,2464,3918,418,1872,3748,2898,1702,852,2728,3414 
    DW   682,1368,3244,2394,1198,348,2224,3678,178,1632,3892,2658 
    DW   1846,612,2872,3174,826,1128,3388,2154,1342,108,2368,4014 
    DW   322,1968,3652,2994,1606,948,2632,3510,586,1464,3148,2490 
    DW   1102,444,2128,3774,Li4 ; c = 64 
;
    DW   84,2752,3990,706,1944,3268,2970,1222,924,2248,3486,202 
    DW   1440,3916,2466,1870,420,2896,3750,850,1704,3412,2730,1366 
    DW   684,2392,3246,346,1200,3676,2226,1630,180,2656,3894,610 
    DW   1848,3172,2874,1126,828,2152,3390,106,1344,4012,2370,1966 
    DW   324,2992,3654,946,1608,3508,2634,1462,588,2488,3150,442 
    DW   1104,3772,2130,1726,Li4 ; c = 64 
;
    DW   86,704,3992,3266,1946,1220,2972,2246,926,200,3488,3914 
    DW   1442,1868,2468,2894,422,848,3752,3410,1706,1364,2732,2390 
    DW   686,344,3248,3674,1202,1628,2228,2654,182,608,3896,3170 
    DW   1850,1124,2876,2150,830,104,3392,4010,1346,1964,2372,2990 
    DW   326,944,3656,3506,1610,1460,2636,2486,590,440,3152,3770 
    DW   1106,1724,2132,2750,Li4 ; c = 64 
;
    DW   88,3264,3994,1218,1948,2244,2974,198,928,3912,3490,1866 
    DW   1444,2892,2470,846,424,3408,3754,1362,1708,2388,2734,342 
    DW   688,3672,3250,1626,1204,2652,2230,606,184,3168,3898,1122 
    DW   1852,2148,2878,102,832,4008,3394,1962,1348,2988,2374,942 
    DW   328,3504,3658,1458,1612,2484,2638,438,592,3768,3154,1722 
    DW   1108,2748,2134,702,Li4 ; c = 64 
;
    DW   90,1216,3996,2242,1950,196,2976,3910,930,1864,3492,2890 
    DW   1446,844,2472,3406,426,1360,3756,2386,1710,340,2736,3670 
    DW   690,1624,3252,2650,1206,604,2232,3166,186,1120,3900,2146 
    DW   1854,100,2880,4006,834,1960,3396,2986,1350,940,2376,3502 
    DW   330,1456,3660,2482,1614,436,2640,3766,594,1720,3156,2746 
    DW   1110,700,2136,3262,Li4 ; c = 64 
;
    DW   92,2240,3998,194,1952,3908,2978,1862,932,2888,3494,842 
    DW   1448,3404,2474,1358,428,2384,3758,338,1712,3668,2738,1622 
    DW   692,2648,3254,602,1208,3164,2234,1118,188,2144,3902,98 
    DW   1856,4004,2882,1958,836,2984,3398,938,1352,3500,2378,1454 
    DW   332,2480,3662,434,1616,3764,2642,1718,596,2744,3158,698 
    DW   1112,3260,2138,1214,Li4 ; c = 64 
;
    DW   94,192,4000,3906,1954,1860,2980,2886,934,840,3496,3402 
    DW   1450,1356,2476,2382,430,336,3760,3666,1714,1620,2740,2646 
    DW   694,600,3256,3162,1210,1116,2236,2142,190,96,3904,4002 
    DW   1858,1956,2884,2982,838,936,3400,3498,1354,1452,2380,2478 
    DW   334,432,3664,3762,1618,1716,2644,2742,598,696,3160,3258 
    DW   1114,1212,2140,2238,Li4 ; c = 64 
;
; Cycle structure and table for D = 1024
;
TqA DW   Li4
    DW   0,Li4 ; c = 1 
    DW   4,2048,4092,Li4 ; c = 3 
    DW   8,3072,4084,1028,2040,2056,3068,12,1024,4088,2052,2044,Li4 ; c = 12 
    DW   16,3584,4068,1540,2024,2568,3052,524,1008,3088,3572,1044 
    DW   1528,2072,2556,28,512,4080,3076,2036,1032,3064,2060,1020,Li4 ; c = 24 
    DW   20,1536,4072,2564,2028,520,3056,3084,1012,1040,3576,2068 
    DW   1532,24,2560,4076,516,2032,3080,3060,1036,1016,2064,3580,Li4 ; c = 24 
;
    DW   32,3840,4036,1796,1992,2824,3020,780,976,3344,3540,1300 
    DW   1496,2328,2524,284,480,3616,3812,1572,1768,2600,2796,556 
    DW   752,3120,3316,1076,1272,2104,2300,60,256,4064,3588,2020 
    DW   1544,3048,2572,1004,528,3568,3092,1524,1048,2552,2076,508,Li4 ; c = 48 
;
    DW   36,1792,4040,2820,1996,776,3024,3340,980,1296,3544,2324 
    DW   1500,280,2528,3612,484,1568,3816,2596,1772,552,2800,3116 
    DW   756,1072,3320,2100,1276,56,2304,4060,260,2016,3592,3044 
    DW   1548,1000,2576,3564,532,1520,3096,2548,1052,504,2080,3836,Li4 ; c = 48 
;
    DW   40,2816,4044,772,2000,3336,3028,1292,984,2320,3548,276 
    DW   1504,3608,2532,1564,488,2592,3820,548,1776,3112,2804,1068 
    DW   760,2096,3324,52,1280,4056,2308,2012,264,3040,3596,996 
    DW   1552,3560,2580,1516,536,2544,3100,500,1056,3832,2084,1788,Li4 ; c = 48 
;
    DW   44,768,4048,3332,2004,1288,3032,2316,988,272,3552,3604 
    DW   1508,1560,2536,2588,492,544,3824,3108,1780,1064,2808,2092 
    DW   764,48,3328,4052,1284,2008,2312,3036,268,992,3600,3556 
    DW   1556,1512,2584,2540,540,496,3104,3828,1060,1784,2088,2812,Li4 ; c = 48 
;
    DW   64,3968,3972,1924,1928,2952,2956,908,912,3472,3476,1428 
    DW   1432,2456,2460,412,416,3744,3748,1700,1704,2728,2732,684 
    DW   688,3248,3252,1204,1208,2232,2236,188,192,3904,3908,1860 
    DW   1864,2888,2892,844,848,3408,3412,1364,1368,2392,2396,348 
    DW   352,3680,3684,1636,1640,2664,2668,620,624,3184,3188,1140 
    DW   1144,2168,2172,124,128,4032,3844,1988,1800,3016,2828,972 
    DW   784,3536,3348,1492,1304,2520,2332,476,288,3808,3620,1764 
    DW   1576,2792,2604,748,560,3312,3124,1268,1080,2296,2108,252,Li4 ; c = 96 
;
    DW   68,1920,3976,2948,1932,904,2960,3468,916,1424,3480,2452 
    DW   1436,408,2464,3740,420,1696,3752,2724,1708,680,2736,3244 
    DW   692,1200,3256,2228,1212,184,2240,3900,196,1856,3912,2884 
    DW   1868,840,2896,3404,852,1360,3416,2388,1372,344,2400,3676 
    DW   356,1632,3688,2660,1644,616,2672,3180,628,1136,3192,2164 
    DW   1148,120,2176,4028,132,1984,3848,3012,1804,968,2832,3532 
    DW   788,1488,3352,2516,1308,472,2336,3804,292,1760,3624,2788 
    DW   1580,744,2608,3308,564,1264,3128,2292,1084,248,2112,3964,Li4 ; c = 96 
;
    DW   72,2944,3980,900,1936,3464,2964,1420,920,2448,3484,404 
    DW   1440,3736,2468,1692,424,2720,3756,676,1712,3240,2740,1196 
    DW   696,2224,3260,180,1216,3896,2244,1852,200,2880,3916,836 
    DW   1872,3400,2900,1356,856,2384,3420,340,1376,3672,2404,1628 
    DW   360,2656,3692,612,1648,3176,2676,1132,632,2160,3196,116 
    DW   1152,4024,2180,1980,136,3008,3852,964,1808,3528,2836,1484 
    DW   792,2512,3356,468,1312,3800,2340,1756,296,2784,3628,740 
    DW   1584,3304,2612,1260,568,2288,3132,244,1088,3960,2116,1916,Li4 ; c = 96 
;
    DW   76,896,3984,3460,1940,1416,2968,2444,924,400,3488,3732 
    DW   1444,1688,2472,2716,428,672,3760,3236,1716,1192,2744,2220 
    DW   700,176,3264,3892,1220,1848,2248,2876,204,832,3920,3396 
    DW   1876,1352,2904,2380,860,336,3424,3668,1380,1624,2408,2652 
    DW   364,608,3696,3172,1652,1128,2680,2156,636,112,3200,4020 
    DW   1156,1976,2184,3004,140,960,3856,3524,1812,1480,2840,2508 
    DW   796,464,3360,3796,1316,1752,2344,2780,300,736,3632,3300 
    DW   1588,1256,2616,2284,572,240,3136,3956,1092,1912,2120,2940,Li4 ; c = 96 
;
    DW   80,3456,3988,1412,1944,2440,2972,396,928,3728,3492,1684 
    DW   1448,2712,2476,668,432,3232,3764,1188,1720,2216,2748,172 
    DW   704,3888,3268,1844,1224,2872,2252,828,208,3392,3924,1348 
    DW   1880,2376,2908,332,864,3664,3428,1620,1384,2648,2412,604 
    DW   368,3168,3700,1124,1656,2152,2684,108,640,4016,3204,1972 
    DW   1160,3000,2188,956,144,3520,3860,1476,1816,2504,2844,460 
    DW   800,3792,3364,1748,1320,2776,2348,732,304,3296,3636,1252 
    DW   1592,2280,2620,236,576,3952,3140,1908,1096,2936,2124,892,Li4 ; c = 96 
;
    DW   84,1408,3992,2436,1948,392,2976,3724,932,1680,3496,2708 
    DW   1452,664,2480,3228,436,1184,3768,2212,1724,168,2752,3884 
    DW   708,1840,3272,2868,1228,824,2256,3388,212,1344,3928,2372 
    DW   1884,328,2912,3660,868,1616,3432,2644,1388,600,2416,3164 
    DW   372,1120,3704,2148,1660,104,2688,4012,644,1968,3208,2996 
    DW   1164,952,2192,3516,148,1472,3864,2500,1820,456,2848,3788 
    DW   804,1744,3368,2772,1324,728,2352,3292,308,1248,3640,2276 
    DW   1596,232,2624,3948,580,1904,3144,2932,1100,888,2128,3452,Li4 ; c = 96 
;
    DW   88,2432,3996,388,1952,3720,2980,1676,936,2704,3500,660 
    DW   1456,3224,2484,1180,440,2208,3772,164,1728,3880,2756,1836 
    DW   712,2864,3276,820,1232,3384,2260,1340,216,2368,3932,324 
    DW   1888,3656,2916,1612,872,2640,3436,596,1392,3160,2420,1116 
    DW   376,2144,3708,100,1664,4008,2692,1964,648,2992,3212,948 
    DW   1168,3512,2196,1468,152,2496,3868,452,1824,3784,2852,1740 
    DW   808,2768,3372,724,1328,3288,2356,1244,312,2272,3644,228 
    DW   1600,3944,2628,1900,584,2928,3148,884,1104,3448,2132,1404,Li4 ; c = 96 
;
    DW   92,384,4000,3716,1956,1672,2984,2700,940,656,3504,3220 
    DW   1460,1176,2488,2204,444,160,3776,3876,1732,1832,2760,2860 
    DW   716,816,3280,3380,1236,1336,2264,2364,220,320,3936,3652 
    DW   1892,1608,2920,2636,876,592,3440,3156,1396,1112,2424,2140 
    DW   380,96,3712,4004,1668,1960,2696,2988,652,944,3216,3508 
    DW   1172,1464,2200,2492,156,448,3872,3780,1828,1736,2856,2764 
    DW   812,720,3376,3284,1332,1240,2360,2268,316,224,3648,3940 
    DW   1604,1896,2632,2924,588,880,3152,3444,1108,1400,2136,2428,Li4 ; c = 96 
;
; Cycle structure and table for D = 512
;
Tq9 DW   Li4
    DW   0,Li4 ; c = 1 
    DW   8,2048,4088,Li4 ; c = 3 
    DW   16,3072,4072,1032,2032,2064,3064,24,1024,4080,2056,2040,Li4 ; c = 12 
    DW   32,3584,4040,1544,2000,2576,3032,536,992,3104,3560,1064 
    DW   1520,2096,2552,56,512,4064,3080,2024,1040,3056,2072,1016,Li4 ; c = 24 
    DW   40,1536,4048,2568,2008,528,3040,3096,1000,1056,3568,2088 
    DW   1528,48,2560,4056,520,2016,3088,3048,1048,1008,2080,3576,Li4 ; c = 24 

    DW   64,3840,3976,1800,1936,2832,2968,792,928,3360,3496,1320 
    DW   1456,2352,2488,312,448,3648,3784,1608,1744,2640,2776,600 
    DW   736,3168,3304,1128,1264,2160,2296,120,256,4032,3592,1992 
    DW   1552,3024,2584,984,544,3552,3112,1512,1072,2544,2104,504,Li4 ; c = 48 
;
    DW   72,1792,3984,2824,1944,784,2976,3352,936,1312,3504,2344 
    DW   1464,304,2496,3640,456,1600,3792,2632,1752,592,2784,3160 
    DW   744,1120,3312,2152,1272,112,2304,4024,264,1984,3600,3016 
    DW   1560,976,2592,3544,552,1504,3120,2536,1080,496,2112,3832,Li4 ; c = 48 
;
    DW   80,2816,3992,776,1952,3344,2984,1304,944,2336,3512,296 
    DW   1472,3632,2504,1592,464,2624,3800,584,1760,3152,2792,1112 
    DW   752,2144,3320,104,1280,4016,2312,1976,272,3008,3608,968 
    DW   1568,3536,2600,1496,560,2528,3128,488,1088,3824,2120,1784,Li4 ; c = 48 
;
    DW   88,768,4000,3336,1960,1296,2992,2328,952,288,3520,3624 
    DW   1480,1584,2512,2616,472,576,3808,3144,1768,1104,2800,2136 
    DW   760,96,3328,4008,1288,1968,2320,3000,280,960,3616,3528 
    DW   1576,1488,2608,2520,568,480,3136,3816,1096,1776,2128,2808,Li4 ; c = 48 
;
    DW   128,3968,3848,1928,1808,2960,2840,920,800,3488,3368,1448 
    DW   1328,2480,2360,440,320,3776,3656,1736,1616,2768,2648,728 
    DW   608,3296,3176,1256,1136,2288,2168,248,Li4 ; c = 32 
;
    DW   136,1920,3856,2952,1816,912,2848,3480,808,1440,3376,2472 
    DW   1336,432,2368,3768,328,1728,3664,2760,1624,720,2656,3288 
    DW   616,1248,3184,2280,1144,240,2176,3960,Li4 ; c = 32 
;
    DW   144,2944,3864,904,1824,3472,2856,1432,816,2464,3384,424 
    DW   1344,3760,2376,1720,336,2752,3672,712,1632,3280,2664,1240 
    DW   624,2272,3192,232,1152,3952,2184,1912,Li4 ; c = 32 
;
    DW   152,896,3872,3464,1832,1424,2864,2456,824,416,3392,3752 
    DW   1352,1712,2384,2744,344,704,3680,3272,1640,1232,2672,2264 
    DW   632,224,3200,3944,1160,1904,2192,2936,Li4 ; c = 32 
;
    DW   160,3456,3880,1416,1840,2448,2872,408,832,3744,3400,1704 
    DW   1360,2736,2392,696,352,3264,3688,1224,1648,2256,2680,216 
    DW   640,3936,3208,1896,1168,2928,2200,888,Li4 ; c = 32 
;
    DW   168,1408,3888,2440,1848,400,2880,3736,840,1696,3408,2728 
    DW   1368,688,2400,3256,360,1216,3696,2248,1656,208,2688,3928 
    DW   648,1888,3216,2920,1176,880,2208,3448,Li4 ; c = 32 
;
    DW   176,2432,3896,392,1856,3728,2888,1688,848,2720,3416,680 
    DW   1376,3248,2408,1208,368,2240,3704,200,1664,3920,2696,1880 
    DW   656,2912,3224,872,1184,3440,2216,1400,Li4 ; c = 32 
;
    DW   184,384,3904,3720,1864,1680,2896,2712,856,672,3424,3240 
    DW   1384,1200,2416,2232,376,192,3712,3912,1672,1872,2704,2904 
    DW   664,864,3232,3432,1192,1392,2224,2424,Li4 ; c = 32 
;
; Cycle structure and table for D = 256
;
Tq8 DW   Li4
    DW   0,Li4 ; c = 1 
    DW   16,2048,4080,Li4 ; c = 3 
    DW   32,3072,4048,1040,2016,2080,3056,48,1024,4064,2064,2032,Li4 ; c = 12 
    DW   64,3584,3984,1552,1952,2592,2992,560,960,3136,3536,1104 
    DW   1504,2144,2544,112,512,4032,3088,2000,1056,3040,2096,1008,Li4 ; c = 24 
    DW   80,1536,4000,2576,1968,544,3008,3120,976,1088,3552,2128 
    DW   1520,96,2560,4016,528,1984,3104,3024,1072,992,2112,3568,Li4 ; c = 24 
;
    DW   128,3840,3856,1808,1824,2848,2864,816,832,3392,3408,1360 
    DW   1376,2400,2416,368,384,3712,3728,1680,1696,2720,2736,688 
    DW   704,3264,3280,1232,1248,2272,2288,240,256,3968,3600,1936 
    DW   1568,2976,2608,944,576,3520,3152,1488,1120,2528,2160,496,Li4 ; c = 48 
;
    DW   144,1792,3872,2832,1840,800,2880,3376,848,1344,3424,2384 
    DW   1392,352,2432,3696,400,1664,3744,2704,1712,672,2752,3248 
    DW   720,1216,3296,2256,1264,224,2304,3952,272,1920,3616,2960 
    DW   1584,928,2624,3504,592,1472,3168,2512,1136,480,2176,3824,Li4 ; c = 48 
;
    DW   160,2816,3888,784,1856,3360,2896,1328,864,2368,3440,336 
    DW   1408,3680,2448,1648,416,2688,3760,656,1728,3232,2768,1200 
    DW   736,2240,3312,208,1280,3936,2320,1904,288,2944,3632,912 
    DW   1600,3488,2640,1456,608,2496,3184,464,1152,3808,2192,1776,Li4 ; c = 48 
;
    DW   176,768,3904,3344,1872,1312,2912,2352,880,320,3456,3664 
    DW   1424,1632,2464,2672,432,640,3776,3216,1744,1184,2784,2224 
    DW   752,192,3328,3920,1296,1888,2336,2928,304,896,3648,3472 
    DW   1616,1440,2656,2480,624,448,3200,3792,1168,1760,2208,2800,Li4 ; c = 48 
;
; Cycle structure and table for D = 128
;
Tq7 DW   Li4
    DW   0,Li4 ; c = 1 
    DW   32,2048,4064,Li4 ; c = 3 
    DW   64,3072,4000,1056,1984,2112,3040,96,1024,4032,2080,2016,Li4 ; c = 12 
    DW   128,3584,3872,1568,1856,2624,2912,608,896,3200,3488,1184 
    DW   1472,2240,2528,224,512,3968,3104,1952,1088,3008,2144,992,Li4 ; c = 24 
    DW   160,1536,3904,2592,1888,576,2944,3168,928,1152,3520,2208 
    DW   1504,192,2560,3936,544,1920,3136,2976,1120,960,2176,3552,Li4 ; c = 24 
;
    DW   256,3840,3616,1824,1600,2880,2656,864,640,3456,3232,1440 
    DW   1216,2496,2272,480,Li4 ; c = 16 
    DW   288,1792,3648,2848,1632,832,2688,3424,672,1408,3264,2464 
    DW   1248,448,2304,3808,Li4 ; c = 16 
    DW   320,2816,3680,800,1664,3392,2720,1376,704,2432,3296,416 
    DW   1280,3776,2336,1760,Li4 ; c = 16 
    DW   352,768,3712,3360,1696,1344,2752,2400,736,384,3328,3744 
    DW   1312,1728,2368,2784,Li4 ; c = 16 
;
; Cycle structure and table for D = 64
;
Tq6 DW   Li4
    DW   0,Li4 ; c = 1 
    DW   64,2048,4032,Li4 ; c = 3 
    DW   128,3072,3904,1088,1920,2176,3008,192,1024,3968,2112,1984,Li4 ; c = 12 
    DW   256,3584,3648,1600,1664,2688,2752,704,768,3328,3392,1344 
    DW   1408,2432,2496,448,512,3840,3136,1856,1152,2944,2240,960,Li4 ; c = 24 
    DW   320,1536,3712,2624,1728,640,2816,3264,832,1280,3456,2368 
    DW   1472,384,2560,3776,576,1792,3200,2880,1216,896,2304,3520,Li4 ; c = 24 
;
; Cycle structure and table for D = 32
;
Tq5 DW   Li4
    DW   0,Li4 ; c = 1 
    DW   128,2048,3968,Li4 ; c = 3 
    DW   256,3072,3712,1152,1792,2304,2944,384,1024,3840,2176,1920,Li4 ; c = 12 
    DW   512,3584,3200,1664,1280,2816,2432,896,Li4 ; c = 8 
    DW   640,1536,3328,2688,1408,768,2560,3456,Li4 ; c = 8 
;
_DATA   ends
;
_TEXT    segment dword public 'CODE'
         assume  CS:_TEXT
         assume  DS:DGROUP
_AR2FA0A proc    near
;========================================
;
; initialisation
         public xsqufftA0_
         extrn  xsqu_:NEAR
         extrn  xfftAQ_:NEAR
xsqufftA0_:
;
;========================================
;
; a => a^2 by Finite Fourier Transform
;
; Choose FFT dimension or traditional method
;
; EDX = number of digits
;
         CMP    EDX,252
         JBE    xsqu_
         MOV    ZGlgD,6     ; FFT dim 2^6 = 64
         CMP    EDX,504
         JBE    Xfft 
         MOV    ZGlgD,7
         CMP    EDX,1008
         JBE    Xfft
         MOV    ZGlgD,8
         CMP    EDX,2016
         JBE    Xfft
         MOV    ZGlgD,9
         CMP    EDX,4032
         JBE    Xfft
         MOV    ZGlgD,10
         CMP    EDX,8064
         JBE    Xfft
         MOV    ZGlgD,11
         CMP    EDX,16128
         JBE    Xfft
         MOV    ZGlgD,12
         CMP    EDX,32256
         JA     xsqu_       ; More than 32256 digits
;
; Save registers
Xfft:    mov    Zcx,ECX
         mov    Zbp,EBP
         mov    Zsi,ESI
         mov    Zdi,EDI
         mov    ZYptr,EAX            ; &a
         mov    ZXptr,EBX            ; &f (fft array)
;
; Clear high order digits
         lea    EDI,[EAX+EDX*4]      ; First high order digit
         lea    ESI,[EAX+EDX*8]      ; Limit
Xfft1:   cmp    EDI,ESI
         jae    Xfft2
         mov    dword ptr [EDI],0
         lea    EDI,4[EDI]
         jmp    Xfft1
;
; Set up FFT parameters
Xfft2:   MOV    ECX,ZGlgD
         MOV    EAX,1
         SHL    EAX,CL
         MOV    ZGDim,EAX   ; Dimension
         NEG    ECX
         ADD    ECX,12
         MOV    EAX,LnF
         SHL    EAX,CL
         MOV    ZGLbF,EAX   ; LnF*4096/D
;
; First Fast Fourier Transform 
         CALL   XfftI       ; D/2 and D/4
         MOV    EAX,ZGDim
         SHR    EAX,3       ; D/8
         MOV    ZFd,EAX
         MOV    ZFb,512
         MOV    ZFj,512*LnF
         MOV    ZGe,4
Xfft4:   MOV    EAX,ZGe
         MOV    ZFe,EAX
         CALL   XfftA
         SHL    ZGe,1
         SHR    ZFj,1
         SHR    ZFb,1
         SHR    ZFd,1
         JNZ    Xfft4
;
; Reduce (mod F)
         CALL   XfftR
;
; X(i)^2 and permute X(i) <=> X(D - i)
         CALL   XfftQ
;
; Second Fast Fourier Transform 
         MOV    EAX,ZGDim
         SHR    EAX,1       ; D/2
         MOV    ZFd,EAX
         MOV    ZFb,2048
         MOV    ZFj,2048*LnF
         MOV    ZGe,1
Xfft6:   MOV    EAX,ZGe
         MOV    ZFe,EAX
         CALL   XfftA
         SHL    ZGe,1
         SHR    ZFj,1
         SHR    ZFb,1
         SHR    ZFd,1
         JNZ    Xfft6
;
; Reduce (mod F) such that X(i) = 0 (mod D) 
         CALL   XfftS
;
; y = X/D,  X(i) < D^2/2 M^2, i = 0, 1, ..., D-2,  X(D-1) = 0
;
         MOV    ECX,ZGlgD
         mov    ESI,ZXptr
         mov    EDI,ZYptr
         MOV    EAX,0[ESI]
;
         MOV    EDX,4[ESI]
         SHRD   EAX,EDX,CL
         MOV    0[EDI],EAX
         MOV    EAX,8[ESI]
         SHRD   EDX,EAX,CL
         MOV    4[EDI],EDX
;
         MOV    EDX,12[ESI]
         SHRD   EAX,EDX,CL
         MOV    8[EDI],EAX
         MOV    EAX,16[ESI]
         SHRD   EDX,EAX,CL
         MOV    12[EDI],EDX
;
         MOV    EDX,20[ESI]
         SHRD   EAX,EDX,CL
         MOV    16[EDI],EAX
         MOV    EAX,24[ESI]
         SHRD   EDX,EAX,CL
         MOV    20[EDI],EDX
;
         MOV    EDX,28[ESI]
         SHRD   EAX,EDX,CL
         MOV    24[EDI],EAX
         MOV    EAX,32[ESI]
         SHRD   EDX,EAX,CL
         MOV    28[EDI],EDX
;
         MOV    EDX,36[ESI]
         SHRD   EAX,EDX,CL
         MOV    32[EDI],EAX
         MOV    EAX,40[ESI]
         SHRD   EDX,EAX,CL
         MOV    36[EDI],EDX
;
         MOV    EDX,44[ESI]
         SHRD   EAX,EDX,CL
         MOV    40[EDI],EAX
         MOV    EAX,48[ESI]
         SHRD   EDX,EAX,CL
         MOV    44[EDI],EDX
;
         MOV    EDX,52[ESI]
         SHRD   EAX,EDX,CL
         MOV    48[EDI],EAX
         MOV    EAX,56[ESI]
         SHRD   EDX,EAX,CL
         MOV    52[EDI],EDX
;
         MOV    EDX,60[ESI]
         SHRD   EAX,EDX,CL
         MOV    56[EDI],EAX
         MOV    EAX,64[ESI]
         SHRD   EDX,EAX,CL
         MOV    60[EDI],EDX
;
         MOV    EDX,68[ESI]
         SHRD   EAX,EDX,CL
         MOV    64[EDI],EAX
         MOV    EAX,72[ESI]
         SHRD   EDX,EAX,CL
         MOV    68[EDI],EDX
;
         MOV    EDX,76[ESI]
         SHRD   EAX,EDX,CL
         MOV    72[EDI],EAX
         MOV    EAX,80[ESI]
         SHRD   EDX,EAX,CL
         MOV    76[EDI],EDX
;
         MOV    EDX,84[ESI]
         SHRD   EAX,EDX,CL
         MOV    80[EDI],EAX
         MOV    EAX,88[ESI]
         SHRD   EDX,EAX,CL
         MOV    84[EDI],EDX
;
         MOV    EDX,92[ESI]
         SHRD   EAX,EDX,CL
         MOV    88[EDI],EAX
         MOV    EAX,96[ESI]
         SHRD   EDX,EAX,CL
         MOV    92[EDI],EDX
;
         MOV    EDX,100[ESI]
         SHRD   EAX,EDX,CL
         MOV    96[EDI],EAX
         MOV    EAX,104[ESI]
         SHRD   EDX,EAX,CL
         MOV    100[EDI],EDX
;
         MOV    EDX,108[ESI]
         SHRD   EAX,EDX,CL
         MOV    104[EDI],EAX
         MOV    EAX,112[ESI]
         SHRD   EDX,EAX,CL
         MOV    108[EDI],EDX
;
         MOV    EDX,116[ESI]
         SHRD   EAX,EDX,CL
         MOV    112[EDI],EAX
         MOV    EAX,120[ESI]
         SHRD   EDX,EAX,CL
         MOV    116[EDI],EDX
;
         MOV    EDX,124[ESI]
         SHRD   EAX,EDX,CL
         MOV    120[EDI],EAX
         MOV    EAX,128[ESI]
         SHRD   EDX,EAX,CL
         MOV    124[EDI],EDX
;
         MOV    dword ptr 128[EDI],0
         add    EDI,LnM
         MOV    EBX,2
         MOV    EBP,ZGDim
         SUB    EBP,2
Xfft8:   xor    ESI,ESI
         MOV    SI,Tb[EBX]
         mov    EAX,ESI
         shl    ESI,7
         lea    ESI,[ESI+EAX*4]         
         add    ESI,ZXptr
         MOV    EAX,0[ESI]
;
         MOV    EDX,4[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+0,EAX
         MOV    EAX,8[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+4,EDX
;
         MOV    EDX,12[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+8,EAX
         MOV    EAX,16[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+12,EDX
;
         MOV    EDX,20[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+16,EAX
         MOV    EAX,24[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+20,EDX
;
         MOV    EDX,28[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+24,EAX
         MOV    EAX,32[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+28,EDX
;
         MOV    EDX,36[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+32,EAX
         MOV    EAX,40[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+36,EDX
;
         MOV    EDX,44[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+40,EAX
         MOV    EAX,48[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+44,EDX
;
         MOV    EDX,52[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+48,EAX
         MOV    EAX,56[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+52,EDX
;
         MOV    EDX,60[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+56,EAX
         MOV    EAX,64[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+60,EDX
;
         MOV    EDX,68[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+64,EAX
         MOV    EAX,72[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+68,EDX
;
         MOV    EDX,76[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+72,EAX
         MOV    EAX,80[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+76,EDX
;
         MOV    EDX,84[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+80,EAX
         MOV    EAX,88[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+84,EDX
;
         MOV    EDX,92[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+88,EAX
         MOV    EAX,96[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+92,EDX
;
         MOV    EDX,100[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+96,EAX
         MOV    EAX,104[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+100,EDX
;
         MOV    EDX,108[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+104,EAX
         MOV    EAX,112[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+108,EDX
;
         MOV    EDX,116[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+112,EAX
         MOV    EAX,120[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+116,EDX
;
         MOV    EDX,124[ESI]
         SHRD   EAX,EDX,CL
         MOV    ZU+120,EAX
         MOV    EAX,128[ESI]
         SHRD   EDX,EAX,CL
         MOV    ZU+124,EDX
;
         MOV    EAX,ZU+0
         ADD    0[EDI],EAX
;
         MOV    EAX,ZU+4
         ADC    4[EDI],EAX
;
         MOV    EAX,ZU+8
         ADC    8[EDI],EAX
;
         MOV    EAX,ZU+12
         ADC    12[EDI],EAX
;
         MOV    EAX,ZU+16
         ADC    16[EDI],EAX
;
         MOV    EAX,ZU+20
         ADC    20[EDI],EAX
;
         MOV    EAX,ZU+24
         ADC    24[EDI],EAX
;
         MOV    EAX,ZU+28
         ADC    28[EDI],EAX
;
         MOV    EAX,ZU+32
         ADC    32[EDI],EAX
;
         MOV    EAX,ZU+36
         ADC    36[EDI],EAX
;
         MOV    EAX,ZU+40
         ADC    40[EDI],EAX
;
         MOV    EAX,ZU+44
         ADC    44[EDI],EAX
;
         MOV    EAX,ZU+48
         ADC    48[EDI],EAX
;
         MOV    EAX,ZU+52
         ADC    52[EDI],EAX
;
         MOV    EAX,ZU+56
         ADC    56[EDI],EAX
;
         MOV    EAX,ZU+60
         ADC    60[EDI],EAX
;
         MOV    EAX,ZU+64
         ADC    64[EDI],EAX
;
         MOV    EAX,ZU+68
         ADC    EAX,0
         MOV    68[EDI],EAX
;
         MOV    EAX,ZU+72
         ADC    EAX,0
         MOV    72[EDI],EAX
;
         MOV    EAX,ZU+76
         ADC    EAX,0
         MOV    76[EDI],EAX
;
         MOV    EAX,ZU+80
         ADC    EAX,0
         MOV    80[EDI],EAX
;
         MOV    EAX,ZU+84
         ADC    EAX,0
         MOV    84[EDI],EAX
;
         MOV    EAX,ZU+88
         ADC    EAX,0
         MOV    88[EDI],EAX
;
         MOV    EAX,ZU+92
         ADC    EAX,0
         MOV    92[EDI],EAX
;
         MOV    EAX,ZU+96
         ADC    EAX,0
         MOV    96[EDI],EAX
;
         MOV    EAX,ZU+100
         ADC    EAX,0
         MOV    100[EDI],EAX
;
         MOV    EAX,ZU+104
         ADC    EAX,0
         MOV    104[EDI],EAX
;
         MOV    EAX,ZU+108
         ADC    EAX,0
         MOV    108[EDI],EAX
;
         MOV    EAX,ZU+112
         ADC    EAX,0
         MOV    112[EDI],EAX
;
         MOV    EAX,ZU+116
         ADC    EAX,0
         MOV    116[EDI],EAX
;
         MOV    EAX,ZU+120
         ADC    EAX,0
         MOV    120[EDI],EAX
;
         MOV    EAX,ZU+124
         ADC    EAX,0
         MOV    124[EDI],EAX
;
         MOV    dword ptr 128[EDI],0
         ADD    EDI,LnM
         ADD    EBX,2
         DEC    EBP
         JNZ    Xfft8
;
; All done, go back
Xfft9:   mov    EDI,Zdi
         mov    ESI,Zsi
         mov    EBP,Zbp
         mov    ECX,Zcx
         retn   
;========================================
; FFT special first step: y => X, d = D/4
;
; X(D/4,0,i) = y(i) +         y(i+D/4)
; X(D/4,1,i) = y(i) + G^(D/4) y(i+D/4)
; X(D/4,2,i) = y(i) -         y(i+D/4)
; X(D/4,3,i) = y(i) - G^(D/4) y(i+D/4)
;
; i = 0, 1, ..., D/4 - 1
;
; 0 <= y(i) < M
; G^(D/4) = (F-1)/2
;
XfftI:   mov    ESI,ZYptr
         mov    EDI,ZXptr
         MOV    EBX,LnM
         MOV    ECX,ZGlgD
         SUB    ECX,2
         SHL    EBX,CL    ; D/4*LnM
         add    EBX,ESI
;
; Pick up high order words
XfftId:  MOV    EBP,60[ESI]
         AND    EBP,00FFFFFFh
         MOV    ECX,EBP
         MOV    EDX,60[EBX]
         AND    EDX,00FFFFFFh
;
; Subtract  y(i+D/4)  from  X(D/4,2,i)
; -M < X(D/4,2,i) < M
         MOV    EAX,0[ESI]
         MOV    0+Lk3[EDI],EAX
         SUB    EAX,0[EBX]
         MOV    0+Lk1[EDI],EAX
;
         MOV    EAX,4[ESI]
         MOV    4+Lk3[EDI],EAX
         SBB    EAX,4[EBX]
         MOV    4+Lk1[EDI],EAX
;
         MOV    EAX,8[ESI]
         MOV    8+Lk3[EDI],EAX
         SBB    EAX,8[EBX]
         MOV    8+Lk1[EDI],EAX
;
         MOV    EAX,12[ESI]
         MOV    12+Lk3[EDI],EAX
         SBB    EAX,12[EBX]
         MOV    12+Lk1[EDI],EAX
;
         MOV    EAX,16[ESI]
         MOV    16+Lk3[EDI],EAX
         SBB    EAX,16[EBX]
         MOV    16+Lk1[EDI],EAX
;
         MOV    EAX,20[ESI]
         MOV    20+Lk3[EDI],EAX
         SBB    EAX,20[EBX]
         MOV    20+Lk1[EDI],EAX
;
         MOV    EAX,24[ESI]
         MOV    24+Lk3[EDI],EAX
         SBB    EAX,24[EBX]
         MOV    24+Lk1[EDI],EAX
;
         MOV    EAX,28[ESI]
         MOV    28+Lk3[EDI],EAX
         SBB    EAX,28[EBX]
         MOV    28+Lk1[EDI],EAX
;
         MOV    EAX,32[ESI]
         MOV    32+Lk3[EDI],EAX
         SBB    EAX,32[EBX]
         MOV    32+Lk1[EDI],EAX
;
         MOV    EAX,36[ESI]
         MOV    36+Lk3[EDI],EAX
         SBB    EAX,36[EBX]
         MOV    36+Lk1[EDI],EAX
;
         MOV    EAX,40[ESI]
         MOV    40+Lk3[EDI],EAX
         SBB    EAX,40[EBX]
         MOV    40+Lk1[EDI],EAX
;
         MOV    EAX,44[ESI]
         MOV    44+Lk3[EDI],EAX
         SBB    EAX,44[EBX]
         MOV    44+Lk1[EDI],EAX
;
         MOV    EAX,48[ESI]
         MOV    48+Lk3[EDI],EAX
         SBB    EAX,48[EBX]
         MOV    48+Lk1[EDI],EAX
;
         MOV    EAX,52[ESI]
         MOV    52+Lk3[EDI],EAX
         SBB    EAX,52[EBX]
         MOV    52+Lk1[EDI],EAX
;
         MOV    EAX,56[ESI]
         MOV    56+Lk3[EDI],EAX
         SBB    EAX,56[EBX]
         MOV    56+Lk1[EDI],EAX
;
         MOV    60+Lk3[EDI],ECX
         SBB    EBP,EDX
         MOV    60+Lk1[EDI],EBP
;
         MOV    EAX,0
         SBB    EAX,0
         MOV    64+Lk1[EDI],EAX
         MOV    68+Lk1[EDI],EAX
         MOV    72+Lk1[EDI],EAX
         MOV    76+Lk1[EDI],EAX
         MOV    80+Lk1[EDI],EAX
         MOV    84+Lk1[EDI],EAX
         MOV    88+Lk1[EDI],EAX
         MOV    92+Lk1[EDI],EAX
         MOV    96+Lk1[EDI],EAX
         MOV    100+Lk1[EDI],EAX
         MOV    104+Lk1[EDI],EAX
         MOV    108+Lk1[EDI],EAX
         MOV    112+Lk1[EDI],EAX
         MOV    116+Lk1[EDI],EAX
         MOV    120+Lk1[EDI],EAX
         MOV    124+Lk1[EDI],EAX
         MOV    128+Lk1[EDI],EAX
;
; Subtract  G^(D/4) y(i+D/4)  from  X(D/4,3,i)
; -M(F-1)/2 < X(D/4,3,i) < M
         MOV    EAX,0
         SUB    EAX,0[EBX]
         MOV    64+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,4[EBX]
         MOV    68+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,8[EBX]
         MOV    72+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,12[EBX]
         MOV    76+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,16[EBX]
         MOV    80+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,20[EBX]
         MOV    84+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,24[EBX]
         MOV    88+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,28[EBX]
         MOV    92+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,32[EBX]
         MOV    96+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,36[EBX]
         MOV    100+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,40[EBX]
         MOV    104+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,44[EBX]
         MOV    108+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,48[EBX]
         MOV    112+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,52[EBX]
         MOV    116+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,56[EBX]
         MOV    120+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,EDX
         MOV    124+Lk3[EDI],EAX
;
         MOV    EAX,0
         SBB    EAX,0
         MOV    128+Lk3[EDI],EAX
;
; Add          y(i+D/4)  to  X(D/4,0,i)
; Add  G^(D/4) y(i+D/4)  to  X(D/4,1,i)
; 0 <= X(D/4,0,i) < 2M
; 0 <= X(D/4,1,i) < M(F-1)/2
         MOV    EAX,0[ESI]
         MOV    EBP,0[EBX]
         MOV    0+Lk2[EDI],EAX
         MOV    64+Lk2[EDI],EBP
         ADD    EAX,EBP
         MOV    0+Lk0[EDI],EAX
         MOV    dword ptr 64+Lk0[EDI],0
;
         MOV    EAX,4[ESI]
         MOV    EBP,4[EBX]
         MOV    4+Lk2[EDI],EAX
         MOV    68+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    4+Lk0[EDI],EAX
         MOV    dword ptr 68+Lk0[EDI],0
;
         MOV    EAX,8[ESI]
         MOV    EBP,8[EBX]
         MOV    8+Lk2[EDI],EAX
         MOV    72+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    8+Lk0[EDI],EAX
         MOV    dword ptr 72+Lk0[EDI],0
;
         MOV    EAX,12[ESI]
         MOV    EBP,12[EBX]
         MOV    12+Lk2[EDI],EAX
         MOV    76+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    12+Lk0[EDI],EAX
         MOV    dword ptr 76+Lk0[EDI],0
;
         MOV    EAX,16[ESI]
         MOV    EBP,16[EBX]
         MOV    16+Lk2[EDI],EAX
         MOV    80+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    16+Lk0[EDI],EAX
         MOV    dword ptr 80+Lk0[EDI],0
;
         MOV    EAX,20[ESI]
         MOV    EBP,20[EBX]
         MOV    20+Lk2[EDI],EAX
         MOV    84+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    20+Lk0[EDI],EAX
         MOV    dword ptr 84+Lk0[EDI],0
;
         MOV    EAX,24[ESI]
         MOV    EBP,24[EBX]
         MOV    24+Lk2[EDI],EAX
         MOV    88+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    24+Lk0[EDI],EAX
         MOV    dword ptr 88+Lk0[EDI],0
;
         MOV    EAX,28[ESI]
         MOV    EBP,28[EBX]
         MOV    28+Lk2[EDI],EAX
         MOV    92+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    28+Lk0[EDI],EAX
         MOV    dword ptr 92+Lk0[EDI],0
;
         MOV    EAX,32[ESI]
         MOV    EBP,32[EBX]
         MOV    32+Lk2[EDI],EAX
         MOV    96+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    32+Lk0[EDI],EAX
         MOV    dword ptr 96+Lk0[EDI],0
;
         MOV    EAX,36[ESI]
         MOV    EBP,36[EBX]
         MOV    36+Lk2[EDI],EAX
         MOV    100+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    36+Lk0[EDI],EAX
         MOV    dword ptr 100+Lk0[EDI],0
;
         MOV    EAX,40[ESI]
         MOV    EBP,40[EBX]
         MOV    40+Lk2[EDI],EAX
         MOV    104+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    40+Lk0[EDI],EAX
         MOV    dword ptr 104+Lk0[EDI],0
;
         MOV    EAX,44[ESI]
         MOV    EBP,44[EBX]
         MOV    44+Lk2[EDI],EAX
         MOV    108+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    44+Lk0[EDI],EAX
         MOV    dword ptr 108+Lk0[EDI],0
;
         MOV    EAX,48[ESI]
         MOV    EBP,48[EBX]
         MOV    48+Lk2[EDI],EAX
         MOV    112+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    48+Lk0[EDI],EAX
         MOV    dword ptr 112+Lk0[EDI],0
;
         MOV    EAX,52[ESI]
         MOV    EBP,52[EBX]
         MOV    52+Lk2[EDI],EAX
         MOV    116+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    52+Lk0[EDI],EAX
         MOV    dword ptr 116+Lk0[EDI],0
;
         MOV    EAX,56[ESI]
         MOV    EBP,56[EBX]
         MOV    56+Lk2[EDI],EAX
         MOV    120+Lk2[EDI],EBP
         ADC    EAX,EBP
         MOV    56+Lk0[EDI],EAX
         MOV    dword ptr 120+Lk0[EDI],0
;
         MOV    60+Lk2[EDI],ECX
         MOV    124+Lk2[EDI],EDX
         ADC    ECX,EDX
         MOV    60+Lk0[EDI],ECX
         MOV    dword ptr 124+Lk0[EDI],0
;
         MOV    dword ptr 128+Lk0[EDI],0
         MOV    dword ptr 128+Lk2[EDI],0
; Next i
         mov    EAX,ZXptr
         ADD    EDI,ZGLbF
         add    EAX,1024*LnF
         ADD    ESI,LnM  
         ADD    EBX,LnM
         CMP    EDI,EAX
         jb     XfftId
         RETN
;====================================================
; FFT general step
;
; X(d,k,i)   = X(2d,k,i) + G^(kd) X(2d,k,i+d)
; X(d,k+e,i) = X(2d,k,i) - G^(kd) X(2d,k,i+d)
;
; k = 0, ..., e-1,  i = 0, ..., d-1
;
; ZFd = d,          ZFe = e, 
; ZFb = d*4096/D,   ZFj = offset to X(2d,k,i+d)
;
XfftA:   mov    ZFk,0          ; k
         mov    ZFkd,0         ; kd
XfftAb:  xor    EDI,EDI
         MOV    ZU+0,0         ; Clear low-order U
         mov    EAX,ZFk
         MOV    ZU+4,0
         mov    DI,Tb[EAX*2]
         MOV    ZU+8,0
         mov    EAX,EDI
         MOV    ZU+12,0
         shl    EDI,7
         MOV    ZU+16,0
         lea    EDI,[EDI+EAX*4]         
         MOV    ZU+20,0
         add    EDI,ZXptr
         MOV    ZU+24,0
         MOV    ZU+28,0
         MOV    ZU+32,0
         MOV    ZU+36,0
         MOV    ZU+40,0
         MOV    ZU+44,0
         MOV    ZU+48,0
         MOV    ZU+52,0
         MOV    ZU+56,0
         MOV    ZU+60,0
         MOV    ZU+64,0
         MOV    ZU+68,0
         MOV    ZU+72,0
         MOV    ZU+76,0
         MOV    ZU+80,0
         MOV    ZU+84,0
         MOV    ZU+88,0
         MOV    ZU+92,0
         MOV    ZU+96,0
         MOV    ZU+100,0
         MOV    ZU+104,0
         MOV    ZU+108,0
         MOV    ZU+112,0
         MOV    ZU+116,0
         MOV    ZU+120,0
         mov    EAX,ZFd
         MOV    ZU+124,0
         mov    ZFi,EAX        ; i  = 0, ..., d-1
;
XfftAd:  MOV    ESI,ZFj
         ADD    ESI,EDI        ; ESI -> X(2d,k,i+d)
         mov    EBX,ZFkd
         shr    EBX,4          ; EBX = [kd/16]
; Clear high-order U
         MOV    EAX,128[ESI]
         SAR    EAX,31
         MOV    ZU+132,EAX
         MOV    ZU+136,EAX
         MOV    ZU+140,EAX
         MOV    ZU+144,EAX
         MOV    ZU+148,EAX
         MOV    ZU+152,EAX
         MOV    ZU+156,EAX
         MOV    ZU+160,EAX
         MOV    ZU+164,EAX
         MOV    ZU+168,EAX
         MOV    ZU+172,EAX
         MOV    ZU+176,EAX
         MOV    ZU+180,EAX
         MOV    ZU+184,EAX
         MOV    ZU+188,EAX
         MOV    ZU+192,EAX
         MOV    ZU+196,EAX
         MOV    ZU+200,EAX
         MOV    ZU+204,EAX
         MOV    ZU+208,EAX
         MOV    ZU+212,EAX
         MOV    ZU+216,EAX
         MOV    ZU+220,EAX
         MOV    ZU+224,EAX
         MOV    ZU+228,EAX
         MOV    ZU+232,EAX
         MOV    ZU+236,EAX
         MOV    ZU+240,EAX
         MOV    ZU+244,EAX
         MOV    ZU+248,EAX
         MOV    ZU+252,EAX
         MOV    ZU+256,EAX
         TEST   byte ptr ZFkd,15
         JNZ    XfftAshf
; U = G^kd X(2d,k,i+d),  kd = 0 (mod 16)
         mov    EAX,0[ESI]
         mov    EDX,4[ESI]
         mov    ZU+0[EBX],EAX
         mov    ZU+4[EBX],EDX
;
         mov    EAX,8[ESI]
         mov    EDX,12[ESI]
         mov    ZU+8[EBX],EAX
         mov    ZU+12[EBX],EDX
;
         mov    EAX,16[ESI]
         mov    EDX,20[ESI]
         mov    ZU+16[EBX],EAX
         mov    ZU+20[EBX],EDX
;
         mov    EAX,24[ESI]
         mov    EDX,28[ESI]
         mov    ZU+24[EBX],EAX
         mov    ZU+28[EBX],EDX
;
         mov    EAX,32[ESI]
         mov    EDX,36[ESI]
         mov    ZU+32[EBX],EAX
         mov    ZU+36[EBX],EDX
;
         mov    EAX,40[ESI]
         mov    EDX,44[ESI]
         mov    ZU+40[EBX],EAX
         mov    ZU+44[EBX],EDX
;
         mov    EAX,48[ESI]
         mov    EDX,52[ESI]
         mov    ZU+48[EBX],EAX
         mov    ZU+52[EBX],EDX
;
         mov    EAX,56[ESI]
         mov    EDX,60[ESI]
         mov    ZU+56[EBX],EAX
         mov    ZU+60[EBX],EDX
;
         mov    EAX,64[ESI]
         mov    EDX,68[ESI]
         mov    ZU+64[EBX],EAX
         mov    ZU+68[EBX],EDX
;
         mov    EAX,72[ESI]
         mov    EDX,76[ESI]
         mov    ZU+72[EBX],EAX
         mov    ZU+76[EBX],EDX
;
         mov    EAX,80[ESI]
         mov    EDX,84[ESI]
         mov    ZU+80[EBX],EAX
         mov    ZU+84[EBX],EDX
;
         mov    EAX,88[ESI]
         mov    EDX,92[ESI]
         mov    ZU+88[EBX],EAX
         mov    ZU+92[EBX],EDX
;
         mov    EAX,96[ESI]
         mov    EDX,100[ESI]
         mov    ZU+96[EBX],EAX
         mov    ZU+100[EBX],EDX
;
         mov    EAX,104[ESI]
         mov    EDX,108[ESI]
         mov    ZU+104[EBX],EAX
         mov    ZU+108[EBX],EDX
;
         mov    EAX,112[ESI]
         mov    EDX,116[ESI]
         mov    ZU+112[EBX],EAX
         mov    ZU+116[EBX],EDX
;
         mov    EAX,120[ESI]
         mov    EDX,124[ESI]
         mov    ZU+120[EBX],EAX
         mov    ZU+124[EBX],EDX
;
         mov    EAX,128[ESI]
         mov    ZU+128[EBX],EAX
XfftAshfret:
; Reduce G^kd X(2d,k,i+d)
         mov    EAX,ZU+0
;
         mov    EDX,ZU+128+0
         mov    EBX,ZU+4
         sub    EAX,EDX
         mov    ECX,ZU+128+4
         mov    ZW+0,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+8
         mov    ZW+4,EBX
;
         mov    EDX,ZU+128+8
         mov    EBX,ZU+12
         sbb    EAX,EDX
         mov    ECX,ZU+128+12
         mov    ZW+8,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+16
         mov    ZW+12,EBX
;
         mov    EDX,ZU+128+16
         mov    EBX,ZU+20
         sbb    EAX,EDX
         mov    ECX,ZU+128+20
         mov    ZW+16,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+24
         mov    ZW+20,EBX
;
         mov    EDX,ZU+128+24
         mov    EBX,ZU+28
         sbb    EAX,EDX
         mov    ECX,ZU+128+28
         mov    ZW+24,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+32
         mov    ZW+28,EBX
;
         mov    EDX,ZU+128+32
         mov    EBX,ZU+36
         sbb    EAX,EDX
         mov    ECX,ZU+128+36
         mov    ZW+32,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+40
         mov    ZW+36,EBX
;
         mov    EDX,ZU+128+40
         mov    EBX,ZU+44
         sbb    EAX,EDX
         mov    ECX,ZU+128+44
         mov    ZW+40,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+48
         mov    ZW+44,EBX
;
         mov    EDX,ZU+128+48
         mov    EBX,ZU+52
         sbb    EAX,EDX
         mov    ECX,ZU+128+52
         mov    ZW+48,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+56
         mov    ZW+52,EBX
;
         mov    EDX,ZU+128+56
         mov    EBX,ZU+60
         sbb    EAX,EDX
         mov    ECX,ZU+128+60
         mov    ZW+56,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+64
         mov    ZW+60,EBX
;
         mov    EDX,ZU+128+64
         mov    EBX,ZU+68
         sbb    EAX,EDX
         mov    ECX,ZU+128+68
         mov    ZW+64,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+72
         mov    ZW+68,EBX
;
         mov    EDX,ZU+128+72
         mov    EBX,ZU+76
         sbb    EAX,EDX
         mov    ECX,ZU+128+76
         mov    ZW+72,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+80
         mov    ZW+76,EBX
;
         mov    EDX,ZU+128+80
         mov    EBX,ZU+84
         sbb    EAX,EDX
         mov    ECX,ZU+128+84
         mov    ZW+80,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+88
         mov    ZW+84,EBX
;
         mov    EDX,ZU+128+88
         mov    EBX,ZU+92
         sbb    EAX,EDX
         mov    ECX,ZU+128+92
         mov    ZW+88,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+96
         mov    ZW+92,EBX
;
         mov    EDX,ZU+128+96
         mov    EBX,ZU+100
         sbb    EAX,EDX
         mov    ECX,ZU+128+100
         mov    ZW+96,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+104
         mov    ZW+100,EBX
;
         mov    EDX,ZU+128+104
         mov    EBX,ZU+108
         sbb    EAX,EDX
         mov    ECX,ZU+128+108
         mov    ZW+104,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+112
         mov    ZW+108,EBX
;
         mov    EDX,ZU+128+112
         mov    EBX,ZU+116
         sbb    EAX,EDX
         mov    ECX,ZU+128+116
         mov    ZW+112,EAX
         sbb    EBX,ECX
         mov    EAX,ZU+120
         mov    ZW+116,EBX
;
         mov    EDX,ZU+128+120
         mov    EBX,ZU+124
         sbb    EAX,EDX
         mov    ECX,ZU+128+124
         mov    ZW+120,EAX
         sbb    EBX,ECX
         mov    EAX,0
         mov    ZW+124,EBX
;
         sbb    EAX,ZU+128+128
         mov    ZW+128,EAX
XfftAoddret:
; X(d,k+e,i) = X(2d,k,i) - G^kd X(2d,k,i+d)
         mov    EAX,0[EDI]
;
         mov    EDX,ZW+0
         mov    EBX,4[EDI]
         sub    EAX,EDX
         mov    ECX,ZW+4
         mov    0[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,8[EDI]
         mov    4[ESI],EBX
;
         mov    EDX,ZW+8
         mov    EBX,12[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+12
         mov    8[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,16[EDI]
         mov    12[ESI],EBX
;
         mov    EDX,ZW+16
         mov    EBX,20[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+20
         mov    16[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,24[EDI]
         mov    20[ESI],EBX
;
         mov    EDX,ZW+24
         mov    EBX,28[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+28
         mov    24[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,32[EDI]
         mov    28[ESI],EBX
;
         mov    EDX,ZW+32
         mov    EBX,36[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+36
         mov    32[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,40[EDI]
         mov    36[ESI],EBX
;
         mov    EDX,ZW+40
         mov    EBX,44[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+44
         mov    40[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,48[EDI]
         mov    44[ESI],EBX
;
         mov    EDX,ZW+48
         mov    EBX,52[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+52
         mov    48[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,56[EDI]
         mov    52[ESI],EBX
;
         mov    EDX,ZW+56
         mov    EBX,60[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+60
         mov    56[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,64[EDI]
         mov    60[ESI],EBX
;
         mov    EDX,ZW+64
         mov    EBX,68[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+68
         mov    64[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,72[EDI]
         mov    68[ESI],EBX
;
         mov    EDX,ZW+72
         mov    EBX,76[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+76
         mov    72[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,80[EDI]
         mov    76[ESI],EBX
;
         mov    EDX,ZW+80
         mov    EBX,84[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+84
         mov    80[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,88[EDI]
         mov    84[ESI],EBX
;
         mov    EDX,ZW+88
         mov    EBX,92[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+92
         mov    88[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,96[EDI]
         mov    92[ESI],EBX
;
         mov    EDX,ZW+96
         mov    EBX,100[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+100
         mov    96[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,104[EDI]
         mov    100[ESI],EBX
;
         mov    EDX,ZW+104
         mov    EBX,108[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+108
         mov    104[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,112[EDI]
         mov    108[ESI],EBX
;
         mov    EDX,ZW+112
         mov    EBX,116[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+116
         mov    112[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,120[EDI]
         mov    116[ESI],EBX
;
         mov    EDX,ZW+120
         mov    EBX,124[EDI]
         sbb    EAX,EDX
         mov    ECX,ZW+124
         mov    120[ESI],EAX
         sbb    EBX,ECX
         mov    EAX,128[EDI]
         mov    124[ESI],EBX
;
         sbb    EAX,ZW+128
         mov    128[ESI],EAX
; X(d,k,i) = X(2d,k,i) + G^kd X(2d,k,i+d)
         mov    EAX,0[EDI]
;
         mov    EDX,ZW+0
         mov    EBX,4[EDI]
         add    EAX,EDX
         mov    ECX,ZW+4
         mov    0[EDI],EAX
         adc    EBX,ECX
         mov    EAX,8[EDI]
         mov    4[EDI],EBX
;
         mov    EDX,ZW+8
         mov    EBX,12[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+12
         mov    8[EDI],EAX
         adc    EBX,ECX
         mov    EAX,16[EDI]
         mov    12[EDI],EBX
;
         mov    EDX,ZW+16
         mov    EBX,20[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+20
         mov    16[EDI],EAX
         adc    EBX,ECX
         mov    EAX,24[EDI]
         mov    20[EDI],EBX
;
         mov    EDX,ZW+24
         mov    EBX,28[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+28
         mov    24[EDI],EAX
         adc    EBX,ECX
         mov    EAX,32[EDI]
         mov    28[EDI],EBX
;
         mov    EDX,ZW+32
         mov    EBX,36[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+36
         mov    32[EDI],EAX
         adc    EBX,ECX
         mov    EAX,40[EDI]
         mov    36[EDI],EBX
;
         mov    EDX,ZW+40
         mov    EBX,44[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+44
         mov    40[EDI],EAX
         adc    EBX,ECX
         mov    EAX,48[EDI]
         mov    44[EDI],EBX
;
         mov    EDX,ZW+48
         mov    EBX,52[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+52
         mov    48[EDI],EAX
         adc    EBX,ECX
         mov    EAX,56[EDI]
         mov    52[EDI],EBX
;
         mov    EDX,ZW+56
         mov    EBX,60[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+60
         mov    56[EDI],EAX
         adc    EBX,ECX
         mov    EAX,64[EDI]
         mov    60[EDI],EBX
;
         mov    EDX,ZW+64
         mov    EBX,68[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+68
         mov    64[EDI],EAX
         adc    EBX,ECX
         mov    EAX,72[EDI]
         mov    68[EDI],EBX
;
         mov    EDX,ZW+72
         mov    EBX,76[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+76
         mov    72[EDI],EAX
         adc    EBX,ECX
         mov    EAX,80[EDI]
         mov    76[EDI],EBX
;
         mov    EDX,ZW+80
         mov    EBX,84[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+84
         mov    80[EDI],EAX
         adc    EBX,ECX
         mov    EAX,88[EDI]
         mov    84[EDI],EBX
;
         mov    EDX,ZW+88
         mov    EBX,92[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+92
         mov    88[EDI],EAX
         adc    EBX,ECX
         mov    EAX,96[EDI]
         mov    92[EDI],EBX
;
         mov    EDX,ZW+96
         mov    EBX,100[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+100
         mov    96[EDI],EAX
         adc    EBX,ECX
         mov    EAX,104[EDI]
         mov    100[EDI],EBX
;
         mov    EDX,ZW+104
         mov    EBX,108[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+108
         mov    104[EDI],EAX
         adc    EBX,ECX
         mov    EAX,112[EDI]
         mov    108[EDI],EBX
;
         mov    EDX,ZW+112
         mov    EBX,116[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+116
         mov    112[EDI],EAX
         adc    EBX,ECX
         mov    EAX,120[EDI]
         mov    116[EDI],EBX
;
         mov    EDX,ZW+120
         mov    EBX,124[EDI]
         adc    EAX,EDX
         mov    ECX,ZW+124
         mov    120[EDI],EAX
         adc    EBX,ECX
         mov    EAX,128[EDI]
         mov    124[EDI],EBX
;
         adc    EAX,ZW+128
         mov    128[EDI],EAX
; Next i
         ADD    EDI,ZGLbF
         DEC    ZFi
         JNZ    XfftAd
; Next k
         inc    ZFk
         mov    EAX,ZFb
         ADD    ZFkd,EAX
         DEC    ZFe
         JNZ    XfftAb
         RETN
;
; U = G^kd X(2d,k,i+d),  kd > 0 (mod 16)
XfftAshf:
         mov    CL,byte ptr ZFkd
         AND    CL,14
         SHR    CL,1
         MOV    EAX,128[ESI]
;
         MOV    EDX,124[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+128[EBX],EAX
         MOV    EAX,120[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+124[EBX],EDX
;
         MOV    EDX,116[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+120[EBX],EAX
         MOV    EAX,112[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+116[EBX],EDX
;
         MOV    EDX,108[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+112[EBX],EAX
         MOV    EAX,104[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+108[EBX],EDX
;
         MOV    EDX,100[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+104[EBX],EAX
         MOV    EAX,96[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+100[EBX],EDX
;
         MOV    EDX,92[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+96[EBX],EAX
         MOV    EAX,88[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+92[EBX],EDX
;
         MOV    EDX,84[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+88[EBX],EAX
         MOV    EAX,80[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+84[EBX],EDX
;
         MOV    EDX,76[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+80[EBX],EAX
         MOV    EAX,72[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+76[EBX],EDX
;
         MOV    EDX,68[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+72[EBX],EAX
         MOV    EAX,64[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+68[EBX],EDX
;
         MOV    EDX,60[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+64[EBX],EAX
         MOV    EAX,56[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+60[EBX],EDX
;
         MOV    EDX,52[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+56[EBX],EAX
         MOV    EAX,48[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+52[EBX],EDX
;
         MOV    EDX,44[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+48[EBX],EAX
         MOV    EAX,40[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+44[EBX],EDX
;
         MOV    EDX,36[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+40[EBX],EAX
         MOV    EAX,32[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+36[EBX],EDX
;
         MOV    EDX,28[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+32[EBX],EAX
         MOV    EAX,24[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+28[EBX],EDX
;
         MOV    EDX,20[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+24[EBX],EAX
         MOV    EAX,16[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+20[EBX],EDX
;
         MOV    EDX,12[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+16[EBX],EAX
         MOV    EAX,8[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+12[EBX],EDX
;
         MOV    EDX,4[ESI]
         SHLD   EAX,EDX,CL
         MOV    ZU+8[EBX],EAX
         MOV    EAX,0[ESI]
         SHLD   EDX,EAX,CL
         MOV    ZU+4[EBX],EDX
;
         SHL    EAX,CL
         MOV    ZU+0[EBX],EAX
         TEST   byte ptr ZFkd,1
         JZ     XfftAshfret
;
; W = U*(2^768 - 2^256),  kd = 1 (mod 16)
;
;   0:            -  32 +  96 + 160 - 224
;   4:            -  36 + 100 + 164 - 228
;   8:            -  40 + 104 + 168 - 232
;  12:            -  44 + 108 + 172 - 236
;  16:            -  48 + 112 + 176 - 240
;  20:            -  52 + 116 + 180 - 244
;  24:            -  56 + 120 + 184 - 248
;  28:            -  60 + 124 + 188 - 252
;  32:      -   0 -  64 + 128 + 192 - 256
;  36:      -   4 -  68 + 132 + 196
;  40:      -   8 -  72 + 136 + 200
;  44:      -  12 -  76 + 140 + 204
;  48:      -  16 -  80 + 144 + 208
;  52:      -  20 -  84 + 148 + 212
;  56:      -  24 -  88 + 152 + 216
;  60:      -  28 -  92 + 156 + 220
;  64:      -  32 -  96 + 160 + 224
;  68:      -  36 - 100 + 164 + 228
;  72:      -  40 - 104 + 168 + 232
;  76:      -  44 - 108 + 172 + 236
;  80:      -  48 - 112 + 176 + 240
;  84:      -  52 - 116 + 180 + 244
;  88:      -  56 - 120 + 184 + 248
;  92:      -  60 - 124 + 188 + 252
;  96: +  0 -  64 - 128 + 192 + 256
; 100: +  4 -  68 - 132 + 196      
; 104: +  8 -  72 - 136 + 200 
; 108: + 12 -  76 - 140 + 204 
; 112: + 16 -  80 - 144 + 208 
; 116: + 20 -  84 - 148 + 212 
; 120: + 24 -  88 - 152 + 216 
; 124: + 28 -  92 - 156 + 220 
;
XfftAodd:
         MOV    EDX,ZU+256
         SAR    EDX,31       ; Sign
         MOV    ECX,0        ; Carry
;
         MOV    EAX,ZU+96
         SUB    EAX,ZU+32
         MOV    ZW+0,EAX
;
         MOV    EAX,ZU+100
         SBB    EAX,ZU+36
         MOV    ZW+4,EAX
;
         MOV    EAX,ZU+104
         SBB    EAX,ZU+40
         MOV    ZW+8,EAX
;
         MOV    EAX,ZU+108
         SBB    EAX,ZU+44
         MOV    ZW+12,EAX
;
         MOV    EAX,ZU+112
         SBB    EAX,ZU+48
         MOV    ZW+16,EAX
;
         MOV    EAX,ZU+116
         SBB    EAX,ZU+52
         MOV    ZW+20,EAX
;
         MOV    EAX,ZU+120
         SBB    EAX,ZU+56
         MOV    ZW+24,EAX
;
         MOV    EAX,ZU+124
         SBB    EAX,ZU+60
         MOV    ZW+28,EAX
;
         MOV    EAX,ZU+128
         SBB    EAX,ZU+64
         MOV    ZW+32,EAX
;
         MOV    EAX,ZU+132
         SBB    EAX,ZU+68
         MOV    ZW+36,EAX
;
         MOV    EAX,ZU+136
         SBB    EAX,ZU+72
         MOV    ZW+40,EAX
;
         MOV    EAX,ZU+140
         SBB    EAX,ZU+76
         MOV    ZW+44,EAX
;
         MOV    EAX,ZU+144
         SBB    EAX,ZU+80
         MOV    ZW+48,EAX
;
         MOV    EAX,ZU+148
         SBB    EAX,ZU+84
         MOV    ZW+52,EAX
;
         MOV    EAX,ZU+152
         SBB    EAX,ZU+88
         MOV    ZW+56,EAX
;
         MOV    EAX,ZU+156
         SBB    EAX,ZU+92
         MOV    ZW+60,EAX
;
         MOV    EAX,ZU+160
         SBB    EAX,ZU+96
         MOV    ZW+64,EAX
;
         MOV    EAX,ZU+164
         SBB    EAX,ZU+100
         MOV    ZW+68,EAX
;
         MOV    EAX,ZU+168
         SBB    EAX,ZU+104
         MOV    ZW+72,EAX
;
         MOV    EAX,ZU+172
         SBB    EAX,ZU+108
         MOV    ZW+76,EAX
;
         MOV    EAX,ZU+176
         SBB    EAX,ZU+112
         MOV    ZW+80,EAX
;
         MOV    EAX,ZU+180
         SBB    EAX,ZU+116
         MOV    ZW+84,EAX
;
         MOV    EAX,ZU+184
         SBB    EAX,ZU+120
         MOV    ZW+88,EAX
;
         MOV    EAX,ZU+188
         SBB    EAX,ZU+124
         MOV    ZW+92,EAX
;
         MOV    EAX,ZU+192
         SBB    EAX,ZU+128
         MOV    ZW+96,EAX
;
         MOV    EAX,ZU+196
         SBB    EAX,ZU+132
         MOV    ZW+100,EAX
;
         MOV    EAX,ZU+200
         SBB    EAX,ZU+136
         MOV    ZW+104,EAX
;
         MOV    EAX,ZU+204
         SBB    EAX,ZU+140
         MOV    ZW+108,EAX
;
         MOV    EAX,ZU+208
         SBB    EAX,ZU+144
         MOV    ZW+112,EAX
;
         MOV    EAX,ZU+212
         SBB    EAX,ZU+148
         MOV    ZW+116,EAX
;
         MOV    EAX,ZU+216
         SBB    EAX,ZU+152
         MOV    ZW+120,EAX
;
         MOV    EAX,ZU+220
         SBB    EAX,ZU+156
         MOV    ZW+124,EAX
;
         SBB    ECX,0
;
         MOV    EAX,ZU+0
         ADD    ZW+96,EAX
         MOV    EAX,ZU+4
         ADC    ZW+100,EAX
         MOV    EAX,ZU+8
         ADC    ZW+104,EAX
         MOV    EAX,ZU+12
         ADC    ZW+108,EAX
         MOV    EAX,ZU+16
         ADC    ZW+112,EAX
         MOV    EAX,ZU+20
         ADC    ZW+116,EAX
         MOV    EAX,ZU+24
         ADC    ZW+120,EAX
         MOV    EAX,ZU+28
         ADC    ZW+124,EAX
         ADC    ECX,0
;
         MOV    EAX,ZU+0
         SUB    ZW+32,EAX
         MOV    EAX,ZU+4
         SBB    ZW+36,EAX
         MOV    EAX,ZU+8
         SBB    ZW+40,EAX
         MOV    EAX,ZU+12
         SBB    ZW+44,EAX
         MOV    EAX,ZU+16
         SBB    ZW+48,EAX
         MOV    EAX,ZU+20
         SBB    ZW+52,EAX
         MOV    EAX,ZU+24
         SBB    ZW+56,EAX
         MOV    EAX,ZU+28
         SBB    ZW+60,EAX
         MOV    EAX,ZU+32
         SBB    ZW+64,EAX
         MOV    EAX,ZU+36
         SBB    ZW+68,EAX
         MOV    EAX,ZU+40
         SBB    ZW+72,EAX
         MOV    EAX,ZU+44
         SBB    ZW+76,EAX
         MOV    EAX,ZU+48
         SBB    ZW+80,EAX
         MOV    EAX,ZU+52
         SBB    ZW+84,EAX
         MOV    EAX,ZU+56
         SBB    ZW+88,EAX
         MOV    EAX,ZU+60
         SBB    ZW+92,EAX
         MOV    EAX,ZU+64
         SBB    ZW+96,EAX
         MOV    EAX,ZU+68
         SBB    ZW+100,EAX
         MOV    EAX,ZU+72
         SBB    ZW+104,EAX
         MOV    EAX,ZU+76
         SBB    ZW+108,EAX
         MOV    EAX,ZU+80
         SBB    ZW+112,EAX
         MOV    EAX,ZU+84
         SBB    ZW+116,EAX
         MOV    EAX,ZU+88
         SBB    ZW+120,EAX
         MOV    EAX,ZU+92
         SBB    ZW+124,EAX
         SBB    ECX,0
;
         MOV    EAX,ZU+224
         SUB    ZW+0,EAX
         MOV    EAX,ZU+228
         SBB    ZW+4,EAX
         MOV    EAX,ZU+232
         SBB    ZW+8,EAX
         MOV    EAX,ZU+236
         SBB    ZW+12,EAX
         MOV    EAX,ZU+240
         SBB    ZW+16,EAX
         MOV    EAX,ZU+244
         SBB    ZW+20,EAX
         MOV    EAX,ZU+248
         SBB    ZW+24,EAX
         MOV    EAX,ZU+252
         SBB    ZW+28,EAX
         MOV    EAX,ZU+256
         SBB    ZW+32,EAX
         SBB    ZW+36,EDX
         SBB    ZW+40,EDX
         SBB    ZW+44,EDX
         SBB    ZW+48,EDX
         SBB    ZW+52,EDX
         SBB    ZW+56,EDX
         SBB    ZW+60,EDX
         SBB    ZW+64,EDX
         SBB    ZW+68,EDX
         SBB    ZW+72,EDX
         SBB    ZW+76,EDX
         SBB    ZW+80,EDX
         SBB    ZW+84,EDX
         SBB    ZW+88,EDX
         SBB    ZW+92,EDX
         SBB    ZW+96,EDX
         SBB    ZW+100,EDX
         SBB    ZW+104,EDX
         SBB    ZW+108,EDX
         SBB    ZW+112,EDX
         SBB    ZW+116,EDX
         SBB    ZW+120,EDX
         SBB    ZW+124,EDX
         SBB    ECX,EDX
;
         MOV    EAX,ZU+160
         ADD    ZW+0,EAX
         MOV    EAX,ZU+164
         ADC    ZW+4,EAX
         MOV    EAX,ZU+168
         ADC    ZW+8,EAX
         MOV    EAX,ZU+172
         ADC    ZW+12,EAX
         MOV    EAX,ZU+176
         ADC    ZW+16,EAX
         MOV    EAX,ZU+180
         ADC    ZW+20,EAX
         MOV    EAX,ZU+184
         ADC    ZW+24,EAX
         MOV    EAX,ZU+188
         ADC    ZW+28,EAX
         MOV    EAX,ZU+192
         ADC    ZW+32,EAX
         MOV    EAX,ZU+196
         ADC    ZW+36,EAX
         MOV    EAX,ZU+200
         ADC    ZW+40,EAX
         MOV    EAX,ZU+204
         ADC    ZW+44,EAX
         MOV    EAX,ZU+208
         ADC    ZW+48,EAX
         MOV    EAX,ZU+212
         ADC    ZW+52,EAX
         MOV    EAX,ZU+216
         ADC    ZW+56,EAX
         MOV    EAX,ZU+220
         ADC    ZW+60,EAX
         MOV    EAX,ZU+224
         ADC    ZW+64,EAX
         MOV    EAX,ZU+228
         ADC    ZW+68,EAX
         MOV    EAX,ZU+232
         ADC    ZW+72,EAX
         MOV    EAX,ZU+236
         ADC    ZW+76,EAX
         MOV    EAX,ZU+240
         ADC    ZW+80,EAX
         MOV    EAX,ZU+244
         ADC    ZW+84,EAX
         MOV    EAX,ZU+248
         ADC    ZW+88,EAX
         MOV    EAX,ZU+252
         ADC    ZW+92,EAX
         MOV    EAX,ZU+256
         ADC    ZW+96,EAX
;
         ADC    ZW+100,EDX
         ADC    ZW+104,EDX
         ADC    ZW+108,EDX
         ADC    ZW+112,EDX
         ADC    ZW+116,EDX
         ADC    ZW+120,EDX
         ADC    ZW+124,EDX
         ADC    ECX,EDX
;
         MOV    ZW+128,ECX
         JMP    XfftAoddret
;====================================================
; Reduce X(i) modulo F, i = 0, 1, ..., D-1
;
; Before:  -2^1055 < X(i) < 2^1055
; After:   0 <= X(i) <= 2^1024  
;
; Let X = X(i) = A + 2^1024 B
;
; If X >= 0 then X = A - B (mod F)
;           If A - B < 0 then add F
;
; If X <  0 then X = A + 2^1024 B - 2^1056
;                  = A + 2^32 - B (mod F)
;
XfftR:   MOV    EDI,ZXptr
         MOV    ECX,ZGDim
;
XfftRb:  MOV    EAX,128[EDI]
         CMP    EAX,0
         JE     XfftRx
         MOV    dword ptr 128+[EDI],0
         JL     XfftRn
; X(i) >= 0
         SUB    0[EDI],EAX
         SBB    dword ptr 4[EDI],0
         JNC    XfftRx
         SBB    dword ptr 8[EDI],0
         JNC    XfftRx
;
         lea    EBX,12[EDI]
         mov    EBP,29
XfftRc:  SBB    dword ptr [EBX],0
         JNC    XfftRx
         lea    EBX,4[EBX]
         dec    EBP
         jnz    XfftRc
;
         ADC    dword ptr 0[EDI],0
         JNC    XfftRx
         ADC    dword ptr 4[EDI],0
         JNC    XfftRx
XfftRg:  ADC    dword ptr 8[EDI],0
         JNC    XfftRx
;
         lea    EBX,12[EDI]
         mov    EBP,29
XfftRi:  ADC    dword ptr [EBX],0
         JNC    XfftRx
         lea    EBX,4[EBX]
         dec    EBP
         jnz    XfftRi
; Must be  a + 2^1024,  a < 2^32 
         ADC    dword ptr 128[EDI],0
         TEST   dword ptr 0[EDI],0FFFFFFFFh
         JZ     XfftRx
         DEC    dword ptr 0[EDI]
         MOV    dword ptr 128[EDI],0
         JMP    XfftRx
; X(i) < 0
XfftRn:  SUB    0[EDI],EAX
         JC     XfftRx
         ADD    dword ptr 4[EDI],1
         JC     XfftRg
;
XfftRx:  ADD    EDI,ZGLbF
         DEC    ECX
         JNZ    XfftRb
         RETN
;====================================================
; Determine X(i) from X(i) modulo F and D, 
; i = 0, 1, ..., D-2
;
; Before:  -2^1055 < X(i) < 2^1055
; After:   0 <= X(i) <= D*2^1024, D|X(i)  
;
; As XfftR, but must add  cF  if  X(i) = -c (mod D)
;
XfftS:   MOV    EDI,ZXptr
         MOV    ECX,ZGDim
         DEC    ECX
;
XfftSb:  MOV    EAX,128[EDI]
         CMP    EAX,0
         JE     XfftSt
         MOV    dword ptr 128+[EDI],0
         JL     XfftSn
; X(i) >= 0
         SUB    0[EDI],EAX
         SBB    dword ptr 4[EDI],0
         JNC    XfftSt
         SBB    dword ptr 8[EDI],0
         JNC    XfftSt
;
         lea    EBX,12[EDI]
         mov    EBP,29
XfftSc:  SBB    dword ptr [EBX],0
         JNC    XfftSt
         lea    EBX,4[EBX]
         dec    EBP
         jnz    XfftSc
;
         ADC    dword ptr 0[EDI],0
         JNC    XfftSt
         ADC    dword ptr 4[EDI],0
         JNC    XfftSt
XfftSg:  ADC    dword ptr 8[EDI],0
         JNC    XfftSt
;
         lea    EBX,12[EDI]
         mov    EBP,29
XfftSi:  ADC    dword ptr [EBX],0
         JNC    XfftSt
         lea    EBX,4[EBX]
         dec    EBP
         jnz    XfftSi
; Must be  a + 2^256,  a < 2^32 
         ADC    dword ptr 128[EDI],0
         TEST   dword ptr 0[EDI],0FFFFFFFFh
         JZ     XfftSt
         DEC    dword ptr 0[EDI]
         MOV    dword ptr 128[EDI],0
         JMP    XfftSt
; X(i) < 0
XfftSn:  SUB    0[EDI],EAX
         JC     XfftSt
         ADD    dword ptr 4[EDI],1
         JC     XfftSg
;
XfftSt:  MOV    EAX,0[EDI]
         MOV    EDX,ZGDim
         DEC    EDX           ; D - 1
         AND    EAX,EDX
         JZ     XfftSx
         NEG    EAX
         ADC    EAX,EDX       ; D - X
         ADD    128[EDI],EAX
         ADD    0[EDI],EAX
         ADC    dword ptr 4[EDI],0
         JNC    XfftSx
         ADC    dword ptr 8[EDI],0
         JNC    XfftSx
;
         lea    EBX,12[EDI]
         mov    EBP,30
XfftSv:  ADC    dword ptr [EBX],0
         JNC    XfftSx
         lea    EBX,4[EBX]
         dec    EBP
         jnz    XfftSv
XfftSx:  ADD    EDI,ZGLbF
         DEC    ECX
         JNZ    XfftSb
         RETN
;====================================================
; X(i) => X(i)^2
;
; 0 <= X(i) <= 2^1024
; ZX[SI] -> X(i),  ZX[DI] -> X(i)^2
;
; Get correct control table parameters
XfftQ:   MOV    EBX,13
         SUB    EBX,ZGlgD       ; 13 - log2 D
         MOV    EAX,ZStab[EBX*8]
         lea    EAX,TqC[EAX]
         MOV    ZStab,EAX       ; Table address
         MOV    EAX,ZSind[EBX*8]
         MOV    ZSind,EAX       ; index
;
; Do an element
XfftQe:  MOV    EBX,ZStab
         ADD    EBX,ZSind
         xor    EDI,EDI
         xor    ESI,ESI
         MOV    DI,0[EBX]
         MOV    SI,-2[EBX]
         mov    EAX,EDI
         mov    EDX,ESI
         shl    EDI,7
         shl    ESI,7
         lea    EDI,[EDI+EAX*4]
         lea    ESI,[ESI+EDX*4]
         mov    EAX,ZXptr
         CMP    EDI,Lk4
         lea    EDI,[EDI+EAX]
         lea    ESI,[ESI+EAX]
         JE     XfftQs
         TEST   BYTE PTR[128+ESI],1
         JNZ    XfftQu
         call   xfftAQ_
XfftQk:  SUB    ZSind,2
         JNZ    XfftQe
         RETN
;
; Start of cycle
XfftQs:  mov    ECX,33
XfftQt:  MOV    EAX,[ESI]
         lea    ESI,4[ESI]
         MOV    [EDI],EAX
         lea    EDI,4[EDI]
         dec    ECX
         jnz    XfftQt
         JMP    XfftQk
;
; (2^1024)^2 = 1 (mod F)
XfftQu:  MOV    dword ptr 0[EDI],1
         mov    ECX,32
XfftQv:  MOV    dword ptr 4[EDI],0
         lea    EDI,4[EDI]
         dec    ECX
         jnz    XfftQv
         JMP    XfftQk
;====================================================
;
_AR2FA0A endp
_TEXT    ends
         END    
